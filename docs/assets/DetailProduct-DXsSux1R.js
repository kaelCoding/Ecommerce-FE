import{x as S,_ as q,r as d,p as D,c as r,a as t,F as b,b as I,t as u,g as B,y as F,e as H,h as U,i as O,T as A,z as G,l as z,d as i,A as L,w as k,f as c,v as _,B as C,C as Q}from"./index-BqYgPRIw.js";import{a as R,g as E}from"./product-g7mluu1Z.js";const K=async y=>{try{return await S("POST","/orders",y)}catch(m){throw m}},$={key:0,class:"page-state"},j={key:1,class:"page-state"},J={key:2,class:"product-page-container"},W={class:"main-content-grid"},X={class:"image-gallery"},Y={class:"main-image-wrapper"},Z=["src","alt"],tt={class:"thumbnail-list"},at=["src","onClick"],et={class:"info-panel"},st={class:"product-brand"},nt={class:"product-title"},ot={class:"product-price"},lt={class:"actions"},it={class:"quantity-selector"},dt=["value"],rt={class:"extended-info-grid"},ut={class:"description-section"},ct={class:"pre-line-text"},vt={class:"checkout-modal"},pt={class:"modal-body"},mt={class:"summary"},ht={class:"summary"},ft={class:"summary"},_t={class:"form-group"},yt={class:"form-group"},gt={class:"form-group"},bt={class:"form-group"},kt={class:"payment-options"},Ct={class:"radio-label"},Mt={class:"radio-label"},xt={__name:"DetailProduct",setup(y){const m=z(),s=d(null),M=d([]),h=d(!0),l=d(1),v=d(""),f=d(!1),n=d({name:"",phone:"",address:"",paymentMethod:"cod"}),g=o=>o?new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(o):"",x=()=>l.value++,T=()=>{l.value>1&&l.value--},V=()=>{f.value=!0},p=()=>{f.value=!1},w=async()=>{const o={productName:s.value.name,quantity:l.value,totalPrice:s.value.price*l.value,customerName:n.value.name,customerPhone:n.value.phone,customerAddress:n.value.address,paymentMethod:n.value.paymentMethod};try{await K(o),alert("Đơn hàng của bạn đã được gửi thành công! Chúng tôi sẽ liên hệ để xác nhận."),p(),n.value={name:"",phone:"",address:"",paymentMethod:"cod"}}catch(a){console.error("Failed to submit order:",a),alert("Gửi đơn hàng thất bại. Vui lòng thử lại.")}},N=async()=>{await E().then(o=>{M.value=o})};D(async()=>{var a;const o=m.params.id;if(!o){h.value=!1;return}try{const e=await R(o);await N(),s.value=e,((a=s.value.image_urls)==null?void 0:a.length)>0&&(v.value=s.value.image_urls[0])}catch(e){console.error("Failed to fetch product data:",e),s.value=null}finally{h.value=!1}});const P=()=>{V()};return(o,a)=>(i(),r(b,null,[h.value?(i(),r("div",$,"Đang tải...")):s.value?(i(),r("div",J,[t("main",W,[t("div",X,[t("div",Y,[t("img",{src:v.value,alt:s.value.name,class:"img-main"},null,8,Z)]),t("div",tt,[(i(!0),r(b,null,I(s.value.image_urls,e=>(i(),r("img",{key:e,src:e,class:L({active:v.value===e}),onClick:Tt=>v.value=e,alt:"Thumbnail"},null,10,at))),128))])]),t("div",et,[t("p",st,u(s.value.category_name),1),t("h1",nt,u(s.value.name),1),t("p",ot,u(g(s.value.price)),1),t("div",lt,[t("div",it,[t("button",{onClick:T,"aria-label":"Giảm số lượng"},"-"),t("input",{type:"text",value:l.value,readonly:"","aria-label":"Số lượng hiện tại"},null,8,dt),t("button",{onClick:x,"aria-label":"Tăng số lượng"},"+")]),t("button",{class:"checkout-btn",onClick:P},a[5]||(a[5]=[t("i",{class:"fas fa-credit-card"},null,-1),B(" THANH TOÁN ")]))]),a[6]||(a[6]=F('<div class="trust-bar" data-v-163c126f><div class="trust-item" data-v-163c126f><i class="fas fa-shield-alt" data-v-163c126f></i> <span data-v-163c126f>Hàng chính hãng 100%</span></div><div class="trust-item" data-v-163c126f><i class="fas fa-truck-fast" data-v-163c126f></i> <span data-v-163c126f>Giao hàng nhanh</span></div><div class="trust-item" data-v-163c126f><i class="fas fa-box-open" data-v-163c126f></i> <span data-v-163c126f>Đổi trả hàng 7 ngày</span></div></div>',1))])]),t("section",rt,[t("div",ut,[a[7]||(a[7]=t("h3",null,"Mô tả chi tiết",-1)),t("p",ct,u(s.value.description||"Chưa có mô tả chi tiết cho sản phẩm này."),1)])])])):(i(),r("div",j,"Không tìm thấy sản phẩm.")),(i(),H(G,{to:"body"},[U(A,{name:"modal-fade"},{default:O(()=>[f.value?(i(),r("div",{key:0,class:"checkout-modal-backdrop",onClick:k(p,["self"])},[t("div",vt,[t("div",{class:"modal-header"},[a[8]||(a[8]=t("h3",null,"Thông tin đặt hàng",-1)),t("button",{class:"close-btn",onClick:p},"×")]),t("div",pt,[t("p",mt,"Sản phẩm: **"+u(s.value.name)+"**",1),t("p",ht,"Số lượng: **"+u(l.value)+"**",1),t("p",ft,"Tổng tiền: **"+u(g(s.value.price*l.value))+"**",1),t("form",{onSubmit:k(w,["prevent"])},[t("div",_t,[a[9]||(a[9]=t("label",{for:"name"},"Họ và tên",-1)),c(t("input",{id:"name",type:"text","onUpdate:modelValue":a[0]||(a[0]=e=>n.value.name=e),required:""},null,512),[[_,n.value.name]])]),t("div",yt,[a[10]||(a[10]=t("label",{for:"phone"},"Số điện thoại",-1)),c(t("input",{id:"phone",type:"tel","onUpdate:modelValue":a[1]||(a[1]=e=>n.value.phone=e),required:""},null,512),[[_,n.value.phone]])]),t("div",gt,[a[11]||(a[11]=t("label",{for:"address"},"Địa chỉ",-1)),c(t("textarea",{id:"address","onUpdate:modelValue":a[2]||(a[2]=e=>n.value.address=e),required:""},null,512),[[_,n.value.address]])]),t("div",bt,[a[14]||(a[14]=t("label",null,"Phương thức thanh toán",-1)),t("div",kt,[t("div",Ct,[c(t("input",{type:"radio","onUpdate:modelValue":a[3]||(a[3]=e=>n.value.paymentMethod=e),value:"cod"},null,512),[[C,n.value.paymentMethod]]),a[12]||(a[12]=t("span",null,"Thanh toán khi nhận hàng",-1))]),t("div",Mt,[c(t("input",{type:"radio","onUpdate:modelValue":a[4]||(a[4]=e=>n.value.paymentMethod=e),value:"bank_transfer"},null,512),[[C,n.value.paymentMethod]]),a[13]||(a[13]=t("span",null,"Chuyển khoản ngân hàng",-1))])])]),t("div",{class:"form-actions"},[t("button",{type:"button",class:"btn-cancel",onClick:p},"Hủy"),a[15]||(a[15]=t("button",{type:"submit",class:"btn-submit"},"Đặt hàng",-1))])],32)])])])):Q("",!0)]),_:1})]))],64))}},Nt=q(xt,[["__scopeId","data-v-163c126f"]]);export{Nt as default};
