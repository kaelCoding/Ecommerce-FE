import{k as D,_ as I,r,j as F,c as d,a as t,F as _,b as C,t as u,l as H,m as U,e as M,n as B,p as O,T as G,q as z,g as A,d as l,x as L,w as x,f as c,v as y,y as T,z as Q}from"./index-DF6qZ6uJ.js";import{a as R,g as j}from"./product-CTG5UuJe.js";import{P as E}from"./Card-BNurAejz.js";const K=async g=>{try{return await D("POST","/orders",g)}catch(v){throw v}},$={key:0,class:"page-state"},J={key:1,class:"page-state"},W={key:2,class:"container"},X={class:"main-content-grid"},Y={class:"image-gallery"},Z={class:"main-image-wrapper"},tt=["src","alt"],et={class:"thumbnail-list"},at=["src","onClick"],st={class:"info-panel"},nt={class:"product-brand"},ot={class:"product-title"},lt={class:"product-price"},it={class:"actions"},dt={class:"quantity-selector"},rt=["value"],ut={class:"extended-info-grid"},ct={class:"description-section"},pt={class:"pre-line-text"},vt={class:"related-products-section"},mt={class:"product-grid"},ht={class:"checkout-modal"},ft={class:"modal-body"},_t={class:"summary"},yt={class:"summary"},gt={class:"summary"},bt={class:"form-group"},kt={class:"form-group"},Ct={class:"form-group"},Mt={class:"form-group"},xt={class:"payment-options"},Tt={class:"radio-label"},Vt={class:"radio-label"},wt={__name:"DetailProduct",setup(g){const v=A(),s=r(null),b=r([]),m=r(!0),i=r(1),p=r(""),h=r(!1),n=r({name:"",phone:"",address:"",paymentMethod:"cod"}),k=o=>o?new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(o):"",V=()=>i.value++,w=()=>{i.value>1&&i.value--},N=()=>{h.value=!0},f=()=>{h.value=!1},P=async()=>{const o={productName:s.value.name,quantity:i.value,totalPrice:s.value.price*i.value,customerName:n.value.name,customerPhone:n.value.phone,customerAddress:n.value.address,paymentMethod:n.value.paymentMethod};try{await K(o),alert("Đơn hàng của bạn đã được gửi thành công! Chúng tôi sẽ liên hệ để xác nhận."),f(),n.value={name:"",phone:"",address:"",paymentMethod:"cod"}}catch(e){console.error("Failed to submit order:",e),alert("Gửi đơn hàng thất bại. Vui lòng thử lại.")}},S=async()=>{await j().then(o=>{b.value=o})};F(async()=>{var e;const o=v.params.id;if(!o){m.value=!1;return}try{const a=await R(o);await S(),s.value=a,((e=s.value.image_urls)==null?void 0:e.length)>0&&(p.value=s.value.image_urls[0])}catch(a){console.error("Failed to fetch product data:",a),s.value=null}finally{m.value=!1}});const q=()=>{N()};return(o,e)=>(l(),d(_,null,[m.value?(l(),d("div",$,"Đang tải...")):s.value?(l(),d("div",W,[t("main",X,[t("div",Y,[t("div",Z,[t("img",{src:p.value,alt:s.value.name,class:"img-main"},null,8,tt)]),t("div",et,[(l(!0),d(_,null,C(s.value.image_urls,a=>(l(),d("img",{key:a,src:a,class:L({active:p.value===a}),onClick:Nt=>p.value=a,alt:"Thumbnail"},null,10,at))),128))])]),t("div",st,[t("p",nt,u(s.value.category_name),1),t("h1",ot,u(s.value.name),1),t("p",lt,u(k(s.value.price)),1),t("div",it,[t("div",dt,[t("button",{onClick:w,"aria-label":"Giảm số lượng"},"-"),t("input",{type:"text",value:i.value,readonly:"","aria-label":"Số lượng hiện tại"},null,8,rt),t("button",{onClick:V,"aria-label":"Tăng số lượng"},"+")]),t("button",{class:"btn-primary",onClick:q},e[5]||(e[5]=[t("i",{class:"fas fa-credit-card"},null,-1),H(" THANH TOÁN ")]))]),e[6]||(e[6]=U('<div class="trust-bar" data-v-e12f38dc><div class="trust-item" data-v-e12f38dc><i class="fas fa-shield-alt" data-v-e12f38dc></i> <span data-v-e12f38dc>Hàng chính hãng 100%</span></div><div class="trust-item" data-v-e12f38dc><i class="fas fa-truck-fast" data-v-e12f38dc></i> <span data-v-e12f38dc>Giao hàng nhanh</span></div><div class="trust-item" data-v-e12f38dc><i class="fas fa-box-open" data-v-e12f38dc></i> <span data-v-e12f38dc>Đổi trả hàng 7 ngày</span></div></div>',1))])]),t("section",ut,[t("div",ct,[e[7]||(e[7]=t("h3",null,"Mô tả chi tiết",-1)),t("p",pt,u(s.value.description||"Chưa có mô tả chi tiết cho sản phẩm này."),1)])]),t("section",vt,[e[8]||(e[8]=t("h2",null,"Sản phẩm tương tự",-1)),t("div",mt,[(l(!0),d(_,null,C(b.value,a=>(l(),M(E,{key:a.ID,product:a},null,8,["product"]))),128))])])])):(l(),d("div",J,"Không tìm thấy sản phẩm.")),(l(),M(z,{to:"body"},[B(G,{name:"modal-fade"},{default:O(()=>[h.value?(l(),d("div",{key:0,class:"checkout-modal-backdrop",onClick:x(f,["self"])},[t("div",ht,[e[16]||(e[16]=t("div",{class:"modal-header"},[t("h3",null,"Thông tin đặt hàng")],-1)),t("div",ft,[t("p",_t,"Sản phẩm: **"+u(s.value.name)+"**",1),t("p",yt,"Số lượng: **"+u(i.value)+"**",1),t("p",gt,"Tổng tiền: **"+u(k(s.value.price*i.value))+"**",1),t("form",{onSubmit:x(P,["prevent"])},[t("div",bt,[e[9]||(e[9]=t("label",{for:"name"},"Họ và tên",-1)),c(t("input",{id:"name",type:"text","onUpdate:modelValue":e[0]||(e[0]=a=>n.value.name=a),required:""},null,512),[[y,n.value.name]])]),t("div",kt,[e[10]||(e[10]=t("label",{for:"phone"},"Số điện thoại",-1)),c(t("input",{id:"phone",type:"tel","onUpdate:modelValue":e[1]||(e[1]=a=>n.value.phone=a),required:""},null,512),[[y,n.value.phone]])]),t("div",Ct,[e[11]||(e[11]=t("label",{for:"address"},"Địa chỉ",-1)),c(t("textarea",{id:"address","onUpdate:modelValue":e[2]||(e[2]=a=>n.value.address=a),required:""},null,512),[[y,n.value.address]])]),t("div",Mt,[e[14]||(e[14]=t("label",null,"Phương thức thanh toán",-1)),t("div",xt,[t("div",Tt,[c(t("input",{type:"radio","onUpdate:modelValue":e[3]||(e[3]=a=>n.value.paymentMethod=a),value:"cod"},null,512),[[T,n.value.paymentMethod]]),e[12]||(e[12]=t("span",null,"Thanh toán khi nhận hàng",-1))]),t("div",Vt,[c(t("input",{type:"radio","onUpdate:modelValue":e[4]||(e[4]=a=>n.value.paymentMethod=a),value:"bank_transfer"},null,512),[[T,n.value.paymentMethod]]),e[13]||(e[13]=t("span",null,"Chuyển khoản ngân hàng",-1))])])]),t("div",{class:"form-actions"},[t("button",{type:"button",class:"btn",onClick:f},"Hủy"),e[15]||(e[15]=t("button",{type:"submit",class:"btn-primary"},"Đặt hàng",-1))])],32)])])])):Q("",!0)]),_:1})]))],64))}},Dt=I(wt,[["__scopeId","data-v-e12f38dc"]]);export{Dt as default};
