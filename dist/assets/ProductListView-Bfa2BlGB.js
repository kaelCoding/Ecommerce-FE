import{u as C,r as u,e as D,N as w,c as o,a as e,A as v,l as d,b as P,F as N,g as B,h as V,P as x,o as l,j as I,t as m,E as L,m as S,L as T}from"./index-2CdpPLmO.js";import{C as F}from"./ConfirmationModal-DQzb7gLk.js";const M={class:"container"},E={class:"content-area"},X={class:"content-header"},$={class:"table-responsive"},H={class:"admin-table"},j={key:1},A=["src","alt"],G={class:"table-actions center"},R=["onClick"],q=["onClick"],O={__name:"ProductListView",setup(z){const{showNotification:c}=C(),h=S(),f=u(!0),r=u(!1),a=u(null),i=u([]);D(async()=>{await g(),f.value=!1});const g=async()=>{try{const n=await w();i.value=n}catch(n){console.error("Failed to get products:",n),c(n,"error")}},p=n=>{h.push({name:"admin-products-edit",params:{id:n}})},_=n=>{a.value=n,r.value=!0},y=async()=>{if(r.value=!1,!!a.value)try{await x(a.value),i.value=i.value.filter(n=>n.ID!==a.value),c("Xóa sản phẩm thành công!")}catch(n){console.error("Failed to delete product:",n),c(n,"error")}finally{a.value=null}},b=()=>{r.value=!1,a.value=null};return(n,t)=>(l(),o("div",M,[t[6]||(t[6]=e("div",{class:"main-header"},[e("h1",null,"Sản Phẩm")],-1)),e("div",E,[e("div",X,[t[2]||(t[2]=e("h2",null,"Danh sách Sản Phẩm",-1)),e("button",{class:"btn btn-primary",onClick:t[0]||(t[0]=s=>v(h).push({name:"admin-products-new"}))},t[1]||(t[1]=[e("i",{class:"fas fa-plus"},null,-1),d(" Thêm Mới ")]))]),e("div",$,[e("table",H,[t[5]||(t[5]=e("thead",null,[e("tr",null,[e("th",null,"Ảnh"),e("th",null,"Tên"),e("th",null,"Danh mục"),e("th",null,"Giá"),e("th",null,"Hành động")])],-1)),f.value?(l(),P(T,{key:0,message:"Đang tải..."})):(l(),o("tbody",j,[(l(!0),o(N,null,B(i.value,s=>(l(),o("tr",{key:s.ID},[e("td",null,[s.image_urls&&s.image_urls.length>0?(l(),o("img",{key:0,src:s.image_urls[0],alt:s.name,class:"table-img"},null,8,A)):I("",!0)]),e("td",null,m(s.name),1),e("td",null,m(s.category_name),1),e("td",null,m(v(L)(s.price)),1),e("td",null,[e("div",G,[e("button",{class:"btn-primary",onClick:k=>p(s.ID)},t[3]||(t[3]=[e("i",{class:"fas fa-edit"},null,-1),d(),e("span",null,"Sửa",-1)]),8,R),e("button",{class:"btn-primary",onClick:k=>_(s.ID)},t[4]||(t[4]=[e("i",{class:"fas fa-trash"},null,-1),d(),e("span",null,"Xóa",-1)]),8,q)])])]))),128))]))])])]),V(F,{show:r.value,title:"Xác nhận xóa sản phẩm",message:"Bạn có chắc chắn muốn xóa sản phẩm này không? Hành động này không thể hoàn tác.",onConfirm:y,onCancel:b},null,8,["show"])]))}};export{O as default};
