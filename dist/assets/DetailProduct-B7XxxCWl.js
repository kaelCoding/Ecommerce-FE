import{_ as j,u as z,r as d,B as q,C as X,P as $,c as r,b as k,a as e,F as T,i as D,t as u,h as m,n as c,g as J,j as K,k as W,T as Y,Q as Z,s as ee,R as te,A as x,o,E as ae,G as h,w as U,L as B,l as I,d as p,v as C,S as H,p as se}from"./index-DeMDEMsO.js";import{b as ne}from"./category-Hcuwu0bM.js";import{a as le}from"./order-DF2dVhzn.js";import{P as oe}from"./Card-ZSfcc8TP.js";const ie={key:1,class:"container"},re={class:"main-content-grid"},ue={class:"image-gallery"},de={class:"main-image-wrapper"},ce=["src","alt"],pe={class:"thumbnail-list"},ve=["src","onClick"],me={class:"info-panel"},he={class:"product-brand"},fe={class:"product-title"},ge={key:0,class:"price-info"},ye={class:"original-price"},be={class:"product-price"},_e={key:1,class:"product-price"},ke={class:"actions"},Ce={class:"quantity-selector"},Ne=["value"],Pe={class:"extended-info-grid"},Me={class:"description-section"},Te={class:"pre-line-text"},xe={class:"related-products-section"},we={class:"product-grid"},Se={class:"checkout-modal"},Ve={class:"modal-body"},qe={key:1},De={class:"summary"},Ue={key:0},Be={class:"form-group"},Ie={class:"form-group"},He={class:"form-group"},Fe={class:"form-group"},Ee={class:"form-group"},Le={class:"payment-options"},Re={class:"radio-label"},Ae={class:"radio-label"},Ge={__name:"DetailProduct",setup(Oe){const f=ee(),N=se(),{showNotification:v}=z(),s=d(null),w=d([]),g=d(!0),P=d(!1),i=d(1),y=d(""),M=d(!1),n=d({name:"",phone:"",address:"",email:"",paymentMethod:"cod"}),F=x,b=q(()=>{var l;return((l=F.value)==null?void 0:l.discountPercentage)||0}),S=q(()=>{var l;return s.value&&b.value>0?s.value.price*(1-b.value):(l=s.value)==null?void 0:l.price}),E=()=>i.value++,L=()=>{i.value>1&&i.value--},R=()=>{M.value=!0},_=()=>{M.value=!1,i.value=1},A=()=>{n.value={name:"",phone:"",address:"",email:"",paymentMethod:"cod"},i.value=1},G=async()=>{P.value=!0;const l={productID:s.value.ID,productName:s.value.name,quantity:i.value,totalPrice:s.value.price*i.value,customerName:n.value.name,customerPhone:n.value.phone,customerAddress:n.value.address,customerEmail:n.value.email,paymentMethod:n.value.paymentMethod};try{await le(l),v("Đặt hàng thành công! Chúng tôi sẽ sớm liên hệ với bạn để xác nhận."),_(),A()}catch(t){console.error("Failed to submit order:",t),v(t,"error")}finally{P.value=!1}},V=async l=>{var t;if(!l){g.value=!1;return}g.value=!0;try{const[a]=await Promise.all([te(l)]);s.value=a,((t=s.value.image_urls)==null?void 0:t.length)>0&&(y.value=s.value.image_urls[0]),w.value=await ne(s.value.category_id)}catch(a){console.error("Failed to fetch product data:",a),s.value=null,v(a,"error")}finally{g.value=!1}};X(async()=>{V(f.params.id)}),$(()=>f.params.id,l=>{l&&(window.scrollTo(0,0),V(l))});const O=()=>{x.value?R():(v("Bạn cần đăng nhập để tiến hành thanh toán.","error"),N.push({path:"/login",query:{redirect:f.fullPath}}))},Q=()=>{x.value?N.push("/chat"):(v("Bạn cần đăng nhập để nhắn tin.","error"),N.push({path:"/login",query:{redirect:f.fullPath}}))};return(l,t)=>(o(),r(T,null,[g.value?(o(),k(B,{key:0,message:"Đang tải..."})):(o(),r("div",ie,[e("main",re,[e("div",ue,[e("div",de,[e("img",{src:y.value,alt:s.value.name,class:"img-main"},null,8,ce)]),e("div",pe,[(o(!0),r(T,null,D(s.value.image_urls,a=>(o(),r("img",{key:a,src:a,class:ae({active:y.value===a}),onClick:Qe=>y.value=a,alt:"Thumbnail"},null,10,ve))),128))])]),e("div",me,[e("p",he,u(s.value.category_name),1),e("h1",fe,u(s.value.name),1),b.value>0?(o(),r("div",ge,[e("p",ye,u(m(h)(s.value.price)),1),e("p",be,u(m(h)(S.value)),1)])):(o(),r("p",_e,u(m(h)(s.value.price)),1)),e("div",ke,[e("div",Ce,[e("button",{onClick:L,"aria-label":"Giảm số lượng"},"-"),e("input",{type:"text",value:i.value,readonly:"","aria-label":"Số lượng hiện tại"},null,8,Ne),e("button",{onClick:E,"aria-label":"Tăng số lượng"},"+")]),e("button",{class:"btn-primary",onClick:O},t[6]||(t[6]=[e("i",{class:"fas fa-credit-card"},null,-1),c(" THANH TOÁN ")])),e("button",{class:"btn-primary",onClick:Q},t[7]||(t[7]=[e("i",{class:"fa-solid fa-comments"},null,-1),c(" NHẮN TIN TUNI ")]))]),t[8]||(t[8]=J('<div class="trust-bar" data-v-ede8fbc6><div class="trust-item" data-v-ede8fbc6><i class="fas fa-shield-alt" data-v-ede8fbc6></i> <span data-v-ede8fbc6>Hàng chính hãng 100%</span></div><div class="trust-item" data-v-ede8fbc6><i class="fas fa-truck-fast" data-v-ede8fbc6></i> <span data-v-ede8fbc6>Giao hàng nhanh</span></div><div class="trust-item" data-v-ede8fbc6><i class="fas fa-box-open" data-v-ede8fbc6></i> <span data-v-ede8fbc6>Đổi trả hàng 7 ngày</span></div></div>',1))])]),e("section",Pe,[e("div",Me,[t[9]||(t[9]=e("h3",null,"Mô tả chi tiết",-1)),e("p",Te,u(s.value.description||"Chưa có mô tả chi tiết cho sản phẩm này."),1)])]),e("section",xe,[t[10]||(t[10]=e("h2",null,"Sản phẩm tương tự",-1)),t[11]||(t[11]=c()),t[12]||(t[12]=e("br",null,null,-1)),e("div",we,[(o(!0),r(T,null,D(w.value.slice(0,6),a=>(o(),k(oe,{key:a.ID,product:a},null,8,["product"]))),128))])])])),(o(),k(Z,{to:"body"},[K(Y,{name:"modal-fade"},{default:W(()=>[M.value?(o(),r("div",{key:0,class:"modal-backdrop",onClick:U(_,["self"])},[e("div",Se,[e("div",{class:"modal-header"},[t[14]||(t[14]=e("h3",null,"Thông tin đặt hàng",-1)),e("button",{class:"close-btn",onClick:_},t[13]||(t[13]=[e("i",{class:"fa-solid fa-xmark"},null,-1)]))]),e("div",Ve,[P.value?(o(),k(B,{key:0,message:"Đang xử lý đơn hàng..."})):(o(),r("div",qe,[e("div",De,[e("p",null,[t[15]||(t[15]=c("Sản phẩm: ")),e("strong",null,u(s.value.name),1)]),e("p",null,[t[16]||(t[16]=c("Số lượng: ")),e("strong",null,u(i.value),1)]),e("p",null,[t[17]||(t[17]=c("Tổng tiền: ")),e("strong",null,u(m(h)(s.value.price*i.value)),1)]),b.value>0?(o(),r("p",Ue,[t[18]||(t[18]=c("Thanh toán: ")),e("strong",null,u(m(h)(S.value*i.value)),1)])):I("",!0)]),e("form",{onSubmit:U(G,["prevent"])},[e("div",Be,[t[19]||(t[19]=e("label",{for:"name"},"Họ và tên",-1)),p(e("input",{id:"name",type:"text",class:"form-input","onUpdate:modelValue":t[0]||(t[0]=a=>n.value.name=a),placeholder:"Nhập tên của bạn",required:""},null,512),[[C,n.value.name]])]),e("div",Ie,[t[20]||(t[20]=e("label",{for:"email"},"Email",-1)),p(e("input",{id:"email",type:"email",class:"form-input","onUpdate:modelValue":t[1]||(t[1]=a=>n.value.email=a),placeholder:"Nhập email của bạn",required:""},null,512),[[C,n.value.email]])]),e("div",He,[t[21]||(t[21]=e("label",{for:"phone"},"Số điện thoại",-1)),p(e("input",{id:"phone",type:"tel",class:"form-input","onUpdate:modelValue":t[2]||(t[2]=a=>n.value.phone=a),placeholder:"Nhập số điện thoại của bạn",required:""},null,512),[[C,n.value.phone]])]),e("div",Fe,[t[22]||(t[22]=e("label",{for:"address"},"Địa chỉ",-1)),p(e("textarea",{id:"address",class:"form-input","onUpdate:modelValue":t[3]||(t[3]=a=>n.value.address=a),placeholder:"Nhập địa chỉ nhận hàng",required:""},null,512),[[C,n.value.address]])]),e("div",Ee,[t[25]||(t[25]=e("label",null,"Phương thức thanh toán",-1)),e("div",Le,[e("div",Re,[p(e("input",{type:"radio","onUpdate:modelValue":t[4]||(t[4]=a=>n.value.paymentMethod=a),value:"cod"},null,512),[[H,n.value.paymentMethod]]),t[23]||(t[23]=e("span",null,"Thanh toán khi nhận hàng",-1))]),e("div",Ae,[p(e("input",{type:"radio","onUpdate:modelValue":t[5]||(t[5]=a=>n.value.paymentMethod=a),value:"bank_transfer"},null,512),[[H,n.value.paymentMethod]]),t[24]||(t[24]=e("span",null,"Chuyển khoản ngân hàng",-1))])])]),e("div",{class:"form-actions"},[e("button",{type:"button",class:"btn",onClick:_},"Hủy"),t[26]||(t[26]=e("button",{type:"submit",class:"btn-primary"},"Xác nhận đặt hàng",-1))])],32)]))])])])):I("",!0)]),_:1})]))],64))}},Je=j(Ge,[["__scopeId","data-v-ede8fbc6"]]);export{Je as default};
