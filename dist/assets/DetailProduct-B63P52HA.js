import{_ as X,u as Y,a as Z,r as m,A as V,h as w,B as ee,s as te,H as ae,I as se,c as d,e as f,j as $,m as U,J as oe,f as o,L as F,d as e,F as q,k as R,t as s,p as c,l as le,T as ne,K as ie,M as re,b as ue,o as r,D as de,G as g,w as j,g as M,v as z,N as E,O as v,P as ce}from"./index-DFV4gWia.js";import{a as pe}from"./order-dQRZRq05.js";import{u as me}from"./product-D2vX-B74.js";import{C as ve}from"./Card-Agc17zVe.js";import"./category-BOZoqxmC.js";const he={key:2,class:"container"},_e={class:"main-content-grid"},fe={class:"image-gallery"},ge={class:"main-image-wrapper"},ye=["src","alt"],be={class:"thumbnail-list"},Pe=["src","onClick"],ke={class:"info-panel"},Ce={class:"product-brand"},we={class:"product-title"},Me={key:0,class:"price-info"},Te={class:"original-price"},xe={class:"product-price"},De={key:1,class:"product-price"},Ne={class:"actions"},Ie={class:"quantity-selector"},Se=["value"],Ve={class:"trust-bar"},$e={class:"trust-item"},qe={class:"trust-item"},Be={class:"trust-item"},Oe={class:"extended-info-grid"},Le={class:"description-section"},Ue={class:"pre-line-text"},Fe={class:"related-products-section"},Re={class:"product-grid"},je={class:"checkout-modal"},ze={class:"modal-header"},Ee={class:"modal-body"},Ae={key:1},Ge={class:"summary"},He={key:0},Je={class:"form-group"},Qe={for:"phone"},Ke=["placeholder"],We={class:"form-group"},Xe={for:"address"},Ye=["placeholder"],Ze={class:"form-group"},et={class:"payment-options"},tt={class:"radio-label"},at={class:"radio-label"},st={class:"form-actions"},ot={type:"submit",class:"btn-primary"},lt={__name:"DetailProduct",setup(nt){const{t:n}=Y(),T=te(),A=ue(),{showNotification:y}=Z(),x=me(),a=m(null),B=m([]),b=m(!0),D=m(!1),p=m(1),P=m(""),N=m(!1),u=m({phone:"",address:"",paymentMethod:"cod"}),k=V(()=>{var i;return((i=w.value)==null?void 0:i.discountPercentage)||0}),I=V(()=>{var i;return a.value&&k.value>0?a.value.price*(1-k.value):(i=a.value)==null?void 0:i.price}),G=()=>p.value++,H=()=>{p.value>1&&p.value--},J=()=>{N.value=!0},C=()=>{N.value=!1,Q()},Q=()=>{u.value={phone:"",address:"",paymentMethod:"cod"},p.value=1},K=async()=>{D.value=!0;const i={productID:a.value.ID,quantity:p.value,customerName:w.value.username,customerPhone:u.value.phone,customerAddress:u.value.address,customerEmail:w.value.email,paymentMethod:u.value.paymentMethod};try{await pe(i),y("Đặt hàng thành công! Chúng tôi sẽ sớm liên hệ với bạn để xác nhận."),C()}catch(t){console.error("Failed to submit order:",t),y(t,"error")}finally{D.value=!1}},O=async i=>{var t;if(!i){b.value=!1;return}b.value=!0;try{const l=await re(i);a.value=l,((t=a.value.image_urls)==null?void 0:t.length)>0&&(P.value=a.value.image_urls[0]);const h=a.value.category_id;let _=x.getRelatedProducts(h,a.value.ID,6);_.length<6&&(await x.ensureCategoryProducts(h),_=x.getRelatedProducts(h,a.value.ID,6)),B.value=_}catch(l){console.error("Failed to fetch product data:",l),a.value=null,y(l,"error")}finally{b.value=!1}};ee(async()=>{O(T.params.id)}),ae(()=>T.params.id,i=>{i&&(window.scrollTo(0,0),O(i))});const W=()=>{w.value?J():(y("Bạn cần đăng nhập để tiến hành thanh toán.","error"),A.push({path:"/login",query:{redirect:T.fullPath}}))},L=V(()=>{if(!a.value)return null;const i={"@context":"https://schema.org/","@type":"Product",name:a.value.name,image:a.value.image_urls[0],description:a.value.description||`Mua ngay ${a.value.name} chính hãng tại Tuni Toku. Sản phẩm thuộc series ${a.value.category_name}. Cam kết chất lượng, giao hàng toàn quốc.`,brand:{"@type":"Brand",name:"Bandai"},sku:`TUNI-${a.value.ID}`,offers:{"@type":"Offer",url:window.location.href,priceCurrency:"VND",price:I.value,availability:"https://schema.org/InStock",itemCondition:"https://schema.org/NewCondition"}};return JSON.stringify(i)});return se(()=>{if(a.value&&a.value.name){const i="Tuni Toku",t=a.value.name,l=a.value.category_name,h=a.value.image_urls[0],_=`${t} | ${l} | ${i}`,S=`Mua ngay ${t} chính hãng tại Tuni Toku. Sản phẩm thuộc series ${l}. Cam kết chất lượng, giao hàng toàn quốc.`;document.title=_,v("description",S,!1),v("og:title",_),v("og:description",S),v("og:url",window.location.href),v("og:image",h),v("twitter:title",_,!1),v("twitter:description",S,!1),v("twitter:image",h,!1),ce()}}),(i,t)=>(r(),d(q,null,[L.value?(r(),f(oe("script"),{key:0,type:"application/ld+json"},{default:U(()=>[c(s(L.value),1)]),_:1})):$("",!0),b.value?(r(),f(F,{key:1,message:o(n)("detailProduct.loading")},null,8,["message"])):(r(),d("div",he,[e("main",_e,[e("div",fe,[e("div",ge,[e("img",{loading:"lazy",src:P.value,alt:a.value.name,class:"img-main"},null,8,ye)]),e("div",be,[(r(!0),d(q,null,R(a.value.image_urls,l=>(r(),d("img",{loading:"lazy",key:l,src:l,class:de({active:P.value===l}),onClick:h=>P.value=l,alt:"Thumbnail"},null,10,Pe))),128))])]),e("div",ke,[e("p",Ce,s(a.value.category_name),1),e("h1",we,s(a.value.name),1),k.value>0?(r(),d("div",Me,[e("p",Te,s(o(g)(a.value.price)),1),e("p",xe,s(o(g)(I.value)),1)])):(r(),d("p",De,s(o(g)(a.value.price)),1)),e("div",Ne,[e("div",Ie,[e("button",{onClick:H,"aria-label":"Giảm số lượng"},"-"),e("input",{type:"text",value:p.value,readonly:"","aria-label":"Số lượng hiện tại"},null,8,Se),e("button",{onClick:G,"aria-label":"Tăng số lượng"},"+")]),e("button",{class:"btn-primary",onClick:W},[t[4]||(t[4]=e("i",{class:"fas fa-credit-card"},null,-1)),c(" "+s(o(n)("detailProduct.payment")),1)])]),e("div",Ve,[e("div",$e,[t[5]||(t[5]=e("i",{class:"fas fa-shield-alt"},null,-1)),t[6]||(t[6]=c()),e("span",null,s(o(n)("detailProduct.fa-shield-alt")),1)]),e("div",qe,[t[7]||(t[7]=e("i",{class:"fas fa-truck-fast"},null,-1)),t[8]||(t[8]=c()),e("span",null,s(o(n)("detailProduct.fa-truck-fast")),1)]),e("div",Be,[t[9]||(t[9]=e("i",{class:"fas fa-box-open"},null,-1)),t[10]||(t[10]=c()),e("span",null,s(o(n)("detailProduct.fa-box-open")),1)])])])]),e("section",Oe,[e("div",Le,[e("h3",null,s(o(n)("detailProduct.description")),1),e("p",Ue,s(a.value.description||"Chưa có mô tả chi tiết cho sản phẩm này."),1)])]),e("section",Fe,[e("h2",null,s(o(n)("detailProduct.relatedProduct")),1),t[11]||(t[11]=c()),t[12]||(t[12]=e("br",null,null,-1)),e("div",Re,[(r(!0),d(q,null,R(B.value,l=>(r(),f(ve,{key:l.ID,product:l},null,8,["product"]))),128))])])])),(r(),f(ie,{to:"body"},[le(ne,{name:"modal-fade"},{default:U(()=>[N.value?(r(),d("div",{key:0,class:"modal-backdrop",onClick:j(C,["self"])},[e("div",je,[e("div",ze,[e("h3",null,s(o(n)("detailProduct.modalHeader")),1),e("button",{class:"close-btn",onClick:C},[...t[13]||(t[13]=[e("i",{class:"fa-solid fa-xmark"},null,-1)])])]),e("div",Ee,[D.value?(r(),f(F,{key:0,message:"Đang xử lý đơn hàng..."})):(r(),d("div",Ae,[e("div",Ge,[e("p",null,[c(s(o(n)("detailProduct.summaryProduct"))+" ",1),e("strong",null,s(a.value.name),1)]),e("p",null,[c(s(o(n)("detailProduct.summaryNumber"))+" ",1),e("strong",null,s(p.value),1)]),e("p",null,[c(s(o(n)("detailProduct.summaryPrice"))+" ",1),e("strong",null,s(o(g)(a.value.price*p.value)),1)]),k.value>0?(r(),d("p",He,[c(s(o(n)("detailProduct.payment"))+": ",1),e("strong",null,s(o(g)(I.value*p.value)),1)])):$("",!0)]),e("form",{onSubmit:j(K,["prevent"])},[e("div",Je,[e("label",Qe,s(o(n)("detailProduct.phone")),1),M(e("input",{id:"phone",type:"tel",class:"form-input","onUpdate:modelValue":t[0]||(t[0]=l=>u.value.phone=l),placeholder:o(n)("detailProduct.phonePlace"),required:""},null,8,Ke),[[z,u.value.phone]])]),e("div",We,[e("label",Xe,s(o(n)("detailProduct.address")),1),M(e("textarea",{id:"address",class:"form-input","onUpdate:modelValue":t[1]||(t[1]=l=>u.value.address=l),placeholder:o(n)("detailProduct.addressPlace"),required:""},null,8,Ye),[[z,u.value.address]])]),e("div",Ze,[e("label",null,s(o(n)("detailProduct.paymentMethod")),1),e("div",et,[e("div",tt,[M(e("input",{type:"radio","onUpdate:modelValue":t[2]||(t[2]=l=>u.value.paymentMethod=l),value:"cod"},null,512),[[E,u.value.paymentMethod]]),e("span",null,s(o(n)("detailProduct.paymentOption1")),1)]),e("div",at,[M(e("input",{type:"radio","onUpdate:modelValue":t[3]||(t[3]=l=>u.value.paymentMethod=l),value:"bank_transfer"},null,512),[[E,u.value.paymentMethod]]),e("span",null,s(o(n)("detailProduct.paymentOption2")),1)])])]),e("div",st,[e("button",{type:"button",class:"btn",onClick:C},s(o(n)("detailProduct.btnCancel")),1),e("button",ot,s(o(n)("detailProduct.btnSubmit")),1)])],32)]))])])])):$("",!0)]),_:1})]))],64))}},pt=X(lt,[["__scopeId","data-v-1e2bcdbc"]]);export{pt as default};
