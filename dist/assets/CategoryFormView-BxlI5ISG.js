import{u as v,r as b,P as l,Q as _,A as C,c as p,a as t,t as h,b as w,w as S,d as k,v as M,g as T,q as x,n as B,o as d,L as D}from"./index-Ca9xZajP.js";import{u as N,b as I}from"./category-DXDY83A7.js";import{u as L}from"./admin-D4QuQ3eM.js";const V={class:"main-header"},q={class:"content-area"},A={class:"form-group"},E={class:"form-actions"},F=["disabled"],U={__name:"CategoryFormView",setup(R){const{showNotification:s}=v(),i=L(),o=b(!1),u=x(),c=B(),r=l(()=>!!u.params.id),g=l(()=>r.value?"Sửa Danh Mục":"Thêm Danh Mục Mới"),y=l(()=>r.value?"Cập Nhật":"Thêm Danh Mục"),n=_({id:null,name:""});C(async()=>{if(r.value){o.value=!0;try{const e=Number(u.params.id),a=await i.fetchCategoryById(e);n.id=a.ID,n.name=a.name}catch(e){console.error("Failed to fetch category data:",e),s(e.message||e,"error"),c.push({name:"admin-categories"})}finally{o.value=!1}}});const f=async()=>{o.value=!0;try{if(r.value){const e={name:n.name},a=await N(n.id,e);i.updateCategory(a),s("Cập nhật danh mục thành công!")}else{const e=await I({name:n.name});i.addCategory(e),s("Thêm danh mục thành công!")}c.push({name:"admin-categories"})}catch(e){console.error("Submit failed:",e),s(e.message||e,"error")}finally{o.value=!1}};return(e,a)=>(d(),p("div",null,[t("div",V,[t("h1",null,h(g.value),1)]),t("div",q,[o.value?(d(),w(D,{key:0,message:"Đang tải..."})):(d(),p("form",{key:1,onSubmit:S(f,["prevent"])},[t("div",A,[a[2]||(a[2]=t("label",{for:"name"},"Tên danh mục",-1)),k(t("input",{"onUpdate:modelValue":a[0]||(a[0]=m=>n.name=m),type:"text",id:"name",class:"form-input",placeholder:"Nhập danh mục",required:""},null,512),[[M,n.name]])]),t("div",E,[t("button",{type:"button",class:"btn",onClick:a[1]||(a[1]=m=>T(c).back())},"Hủy"),t("button",{type:"submit",class:"btn-primary",disabled:o.value},h(o.value?"Đang xử lý...":y.value),9,F)])],32))])]))}};export{U as default};
