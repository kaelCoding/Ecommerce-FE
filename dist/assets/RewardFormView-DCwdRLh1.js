import{_ as q,r as _,A as m,s as S,W as k,H as V,c,d as a,t as f,e as x,w as R,g as l,v as u,f as T,b as B,o as p,L as D}from"./index-DFV4gWia.js";import{u as N}from"./spin-BBhyEYDW.js";const M={class:"container"},U={class:"main-header"},C={class:"content-area"},F={class:"form-group"},I={class:"form-group"},L={class:"form-group"},A={class:"form-group"},E={class:"form-actions"},H=["disabled"],P={__name:"RewardFormView",setup(j){const b=S(),o=B(),r=N(),s=_(!1),d=m(()=>!!b.params.id),v=m(()=>d.value?"Chỉnh sửa Phần Thưởng":"Thêm Phần Thưởng Mới"),y=m(()=>d.value?"Cập Nhật":"Thêm Mới"),t=k({id:null,name:"",value:"",quantity:-1,probability:.1}),h=async n=>{if(Object.assign(t,{id:null,name:"",value:"",quantity:-1,probability:.1}),!!n){s.value=!0;try{r.rewards.length===0&&await r.fetchRewards();const e=Number(n),i=r.rewards.find(w=>w.ID===e);i?(t.id=i.ID,t.name=i.name,t.value=i.value,t.quantity=i.quantity,t.probability=i.probability):o.push({name:"admin-rewards"})}catch(e){console.error("Failed to fetch reward data:",e),o.push({name:"admin-rewards"})}finally{s.value=!1}}};V(()=>b.params.id,n=>{h(n)},{immediate:!0});const g=async()=>{s.value=!0;const n={name:t.name,value:String(t.value),quantity:Number(t.quantity),probability:Number(t.probability)};try{d.value?await r.updateReward(t.id,n):await r.addReward(n),o.push({name:"admin-rewards"})}catch(e){console.error("Submit failed:",e)}finally{s.value=!1}};return(n,e)=>(p(),c("div",M,[a("div",U,[a("h1",null,f(v.value),1)]),a("div",C,[s.value?(p(),x(D,{key:0,message:"Đang xử lý..."})):(p(),c("form",{key:1,onSubmit:R(g,["prevent"])},[a("div",F,[e[5]||(e[5]=a("label",{for:"name"},"Tên phần thưởng",-1)),l(a("input",{type:"text",id:"name",class:"form-input","onUpdate:modelValue":e[0]||(e[0]=i=>t.name=i),placeholder:"Vd: Voucher giảm 10k",required:""},null,512),[[u,t.name]])]),a("div",I,[e[6]||(e[6]=a("label",{for:"value"},"Giá trị",-1)),l(a("input",{type:"text",id:"value",class:"form-input","onUpdate:modelValue":e[1]||(e[1]=i=>t.value=i),placeholder:"Vd: 10000 hoặc freeship39k",required:""},null,512),[[u,t.value]])]),a("div",L,[e[7]||(e[7]=a("label",{for:"quantity"},"Số lượng (-1 là không giới hạn)",-1)),l(a("input",{type:"number",id:"quantity",class:"form-input","onUpdate:modelValue":e[2]||(e[2]=i=>t.quantity=i),required:""},null,512),[[u,t.quantity,void 0,{number:!0}]])]),a("div",A,[e[8]||(e[8]=a("label",{for:"probability"},"Tỉ lệ (0.1 = 10%)",-1)),l(a("input",{type:"number",id:"probability",class:"form-input","onUpdate:modelValue":e[3]||(e[3]=i=>t.probability=i),step:"0.01",min:"0",max:"1",required:""},null,512),[[u,t.probability,void 0,{number:!0}]])]),a("div",E,[a("button",{type:"button",class:"btn",onClick:e[4]||(e[4]=i=>T(o).back())},"Hủy"),a("button",{type:"submit",class:"btn-primary",disabled:s.value},f(y.value),9,H)])],32))])]))}},W=q(P,[["__scopeId","data-v-87e4f2d2"]]);export{W as default};
