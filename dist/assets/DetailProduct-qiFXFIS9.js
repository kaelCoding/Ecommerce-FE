import{m as L,_ as O,n as I,r as d,l as z,p as E,c as r,d as g,a as t,F as k,e as T,t as u,q as w,b as c,x as K,y as Q,z as R,T as X,A as $,i as j,B as J,g as W,f as l,C as Y,D as S,w as V,L as D,h as p,v as C,E as q,G as Z}from"./index-C2scuJsD.js";import{P as tt}from"./Card-DbdHugJh.js";const st=async x=>{try{return await L("POST","/orders",x)}catch(v){throw v}},at={key:1,class:"page-state"},et={key:2,class:"container"},nt={class:"main-content-grid"},lt={class:"image-gallery"},ot={class:"main-image-wrapper"},it=["src","alt"],dt={class:"thumbnail-list"},rt=["src","onClick"],ut={class:"info-panel"},ct={class:"product-brand"},pt={class:"product-title"},vt={class:"product-price"},mt={class:"actions"},ht={class:"quantity-selector"},ft=["value"],gt={class:"extended-info-grid"},yt={class:"description-section"},bt={class:"pre-line-text"},_t={class:"related-products-section"},kt={class:"product-grid"},Ct={class:"checkout-modal"},xt={class:"modal-body"},Mt={key:1},Nt={class:"order-summary"},Pt={class:"form-group"},Tt={class:"form-group"},wt={class:"form-group"},St={class:"form-group"},Vt={class:"payment-options"},Dt={class:"radio-label"},qt={class:"radio-label"},Bt={__name:"DetailProduct",setup(x){const v=j(),{showNotification:y}=I(),e=d(null),M=d([]),m=d(!0),b=d(!1),o=d(1),h=d(""),_=d(!1),n=d({name:"",phone:"",address:"",paymentMethod:"cod"}),B=()=>o.value++,F=()=>{o.value>1&&o.value--},H=()=>{_.value=!0},f=()=>{_.value=!1},U=()=>{n.value={name:"",phone:"",address:"",paymentMethod:"cod"},o.value=1},A=async()=>{b.value=!0;const i={productName:e.value.name,quantity:o.value,totalPrice:e.value.price*o.value,customerName:n.value.name,customerPhone:n.value.phone,customerAddress:n.value.address,paymentMethod:n.value.paymentMethod};try{await st(i),y("Đặt hàng thành công! Chúng tôi sẽ sớm liên hệ với bạn để xác nhận."),f(),U()}catch(s){console.error("Failed to submit order:",s),y("Gửi đơn hàng thất bại. Vui lòng thử lại.","error")}finally{b.value=!1}},N=async i=>{var s;if(!i){m.value=!1;return}m.value=!0;try{const[a,P]=await Promise.all([J(i),W()]);e.value=a,M.value=P,((s=e.value.image_urls)==null?void 0:s.length)>0&&(h.value=e.value.image_urls[0])}catch(a){console.error("Failed to fetch product data:",a),e.value=null,y("Không thể tải dữ liệu sản phẩm.","error")}finally{m.value=!1}};z(async()=>{N(v.params.id)}),E(()=>v.params.id,i=>{i&&(window.scrollTo(0,0),N(i))});const G=()=>{H()};return(i,s)=>(l(),r(k,null,[m.value?(l(),g(D,{key:0,message:"Đang tải..."})):e.value?(l(),r("div",et,[t("main",nt,[t("div",lt,[t("div",ot,[t("img",{src:h.value,alt:e.value.name,class:"img-main"},null,8,it)]),t("div",dt,[(l(!0),r(k,null,T(e.value.image_urls,a=>(l(),r("img",{key:a,src:a,class:Y({active:h.value===a}),onClick:P=>h.value=a,alt:"Thumbnail"},null,10,rt))),128))])]),t("div",ut,[t("p",ct,u(e.value.category_name),1),t("h1",pt,u(e.value.name),1),t("p",vt,u(w(S)(e.value.price)),1),t("div",mt,[t("div",ht,[t("button",{onClick:F,"aria-label":"Giảm số lượng"},"-"),t("input",{type:"text",value:o.value,readonly:"","aria-label":"Số lượng hiện tại"},null,8,ft),t("button",{onClick:B,"aria-label":"Tăng số lượng"},"+")]),t("button",{class:"btn-primary",onClick:G},s[5]||(s[5]=[t("i",{class:"fas fa-credit-card"},null,-1),c(" THANH TOÁN ")]))]),s[6]||(s[6]=K('<div class="trust-bar" data-v-86d5355f><div class="trust-item" data-v-86d5355f><i class="fas fa-shield-alt" data-v-86d5355f></i> <span data-v-86d5355f>Hàng chính hãng 100%</span></div><div class="trust-item" data-v-86d5355f><i class="fas fa-truck-fast" data-v-86d5355f></i> <span data-v-86d5355f>Giao hàng nhanh</span></div><div class="trust-item" data-v-86d5355f><i class="fas fa-box-open" data-v-86d5355f></i> <span data-v-86d5355f>Đổi trả hàng 7 ngày</span></div></div>',1))])]),t("section",gt,[t("div",yt,[s[7]||(s[7]=t("h3",null,"Mô tả chi tiết",-1)),t("p",bt,u(e.value.description||"Chưa có mô tả chi tiết cho sản phẩm này."),1)])]),t("section",_t,[s[8]||(s[8]=t("h2",null,"Sản phẩm tương tự",-1)),s[9]||(s[9]=c()),s[10]||(s[10]=t("br",null,null,-1)),t("div",kt,[(l(!0),r(k,null,T(M.value,a=>(l(),g(tt,{key:a.ID,product:a},null,8,["product"]))),128))])])])):(l(),r("div",at,"Không tìm thấy sản phẩm.")),(l(),g($,{to:"body"},[Q(X,{name:"modal-fade"},{default:R(()=>[_.value?(l(),r("div",{key:0,class:"checkout-modal-backdrop",onClick:V(f,["self"])},[t("div",Ct,[t("div",{class:"modal-header"},[s[12]||(s[12]=t("h3",null,"Thông tin đặt hàng",-1)),t("button",{class:"close-btn",onClick:f},s[11]||(s[11]=[t("i",{class:"fa-solid fa-xmark"},null,-1)]))]),t("div",xt,[b.value?(l(),g(D,{key:0,message:"Đang xử lý đơn hàng..."})):(l(),r("div",Mt,[t("div",Nt,[t("p",null,[s[13]||(s[13]=c("Sản phẩm: ")),t("strong",null,u(e.value.name),1)]),t("p",null,[s[14]||(s[14]=c("Số lượng: ")),t("strong",null,u(o.value),1)]),t("p",null,[s[15]||(s[15]=c("Tổng tiền: ")),t("strong",null,u(w(S)(e.value.price*o.value)),1)])]),t("form",{onSubmit:V(A,["prevent"])},[t("div",Pt,[s[16]||(s[16]=t("label",{for:"name"},"Họ và tên",-1)),p(t("input",{id:"name",type:"text",class:"form-input","onUpdate:modelValue":s[0]||(s[0]=a=>n.value.name=a),placeholder:"Nhập tên của bạn",required:""},null,512),[[C,n.value.name]])]),t("div",Tt,[s[17]||(s[17]=t("label",{for:"phone"},"Số điện thoại",-1)),p(t("input",{id:"phone",type:"tel",class:"form-input","onUpdate:modelValue":s[1]||(s[1]=a=>n.value.phone=a),placeholder:"Nhập số điện thoại của bạn",required:""},null,512),[[C,n.value.phone]])]),t("div",wt,[s[18]||(s[18]=t("label",{for:"address"},"Địa chỉ",-1)),p(t("textarea",{id:"address",class:"form-input","onUpdate:modelValue":s[2]||(s[2]=a=>n.value.address=a),placeholder:"Nhập địa chỉ nhận hàng",required:""},null,512),[[C,n.value.address]])]),t("div",St,[s[21]||(s[21]=t("label",null,"Phương thức thanh toán",-1)),t("div",Vt,[t("div",Dt,[p(t("input",{type:"radio","onUpdate:modelValue":s[3]||(s[3]=a=>n.value.paymentMethod=a),value:"cod"},null,512),[[q,n.value.paymentMethod]]),s[19]||(s[19]=t("span",null,"Thanh toán khi nhận hàng",-1))]),t("div",qt,[p(t("input",{type:"radio","onUpdate:modelValue":s[4]||(s[4]=a=>n.value.paymentMethod=a),value:"bank_transfer"},null,512),[[q,n.value.paymentMethod]]),s[20]||(s[20]=t("span",null,"Chuyển khoản ngân hàng",-1))])])]),t("div",{class:"form-actions"},[t("button",{type:"button",class:"btn",onClick:f},"Hủy"),s[22]||(s[22]=t("button",{type:"submit",class:"btn-primary"},"Xác nhận đặt hàng",-1))])],32)]))])])])):Z("",!0)]),_:1})]))],64))}},Ut=O(Bt,[["__scopeId","data-v-86d5355f"]]);export{Ut as default};
