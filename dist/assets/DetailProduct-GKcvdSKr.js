import{_ as L,u as A,r,y as G,z as I,c as d,b as f,a as t,F as _,g as N,t as u,A as P,l as c,f as O,h as z,i as E,T as Q,B as R,p as j,C as X,o as l,D as $,E as T,w,L as S,d as p,v as k,G as V,j as J}from"./index-2CdpPLmO.js";import{a as K}from"./category-CUGJxbzB.js";import{a as W}from"./order-BuxcKVDu.js";import{P as Y}from"./Card-CgeUxnfB.js";const Z={key:1,class:"container"},tt={class:"main-content-grid"},et={class:"image-gallery"},at={class:"main-image-wrapper"},st=["src","alt"],nt={class:"thumbnail-list"},lt=["src","onClick"],ot={class:"info-panel"},it={class:"product-brand"},rt={class:"product-title"},dt={class:"product-price"},ut={class:"actions"},ct={class:"quantity-selector"},pt=["value"],vt={class:"extended-info-grid"},mt={class:"description-section"},ht={class:"pre-line-text"},ft={class:"related-products-section"},gt={class:"product-grid"},yt={class:"checkout-modal"},bt={class:"modal-body"},_t={key:1},kt={class:"summary"},Ct={class:"form-group"},Mt={class:"form-group"},xt={class:"form-group"},Nt={class:"form-group"},Pt={class:"payment-options"},Tt={class:"radio-label"},wt={class:"radio-label"},St={__name:"DetailProduct",setup(Vt){const C=j(),{showNotification:g}=A(),s=r(null),M=r([]),v=r(!0),y=r(!1),o=r(1),m=r(""),b=r(!1),n=r({name:"",phone:"",address:"",paymentMethod:"cod"}),D=()=>o.value++,q=()=>{o.value>1&&o.value--},B=()=>{b.value=!0},h=()=>{b.value=!1,o.value=1},F=()=>{n.value={name:"",phone:"",address:"",paymentMethod:"cod"},o.value=1},H=async()=>{y.value=!0;const i={productName:s.value.name,quantity:o.value,totalPrice:s.value.price*o.value,customerName:n.value.name,customerPhone:n.value.phone,customerAddress:n.value.address,paymentMethod:n.value.paymentMethod};try{await W(i),g("Đặt hàng thành công! Chúng tôi sẽ sớm liên hệ với bạn để xác nhận."),h(),F()}catch(e){console.error("Failed to submit order:",e),g(e,"error")}finally{y.value=!1}},x=async i=>{var e;if(!i){v.value=!1;return}v.value=!0;try{const[a]=await Promise.all([X(i)]);s.value=a,((e=s.value.image_urls)==null?void 0:e.length)>0&&(m.value=s.value.image_urls[0]),M.value=await K(s.value.category_id)}catch(a){console.error("Failed to fetch product data:",a),s.value=null,g(a,"error")}finally{v.value=!1}};G(async()=>{x(C.params.id)}),I(()=>C.params.id,i=>{i&&(window.scrollTo(0,0),x(i))});const U=()=>{B()};return(i,e)=>(l(),d(_,null,[v.value?(l(),f(S,{key:0,message:"Đang tải..."})):(l(),d("div",Z,[t("main",tt,[t("div",et,[t("div",at,[t("img",{src:m.value,alt:s.value.name,class:"img-main"},null,8,st)]),t("div",nt,[(l(!0),d(_,null,N(s.value.image_urls,a=>(l(),d("img",{key:a,src:a,class:$({active:m.value===a}),onClick:Dt=>m.value=a,alt:"Thumbnail"},null,10,lt))),128))])]),t("div",ot,[t("p",it,u(s.value.category_name),1),t("h1",rt,u(s.value.name),1),t("p",dt,u(P(T)(s.value.price)),1),t("div",ut,[t("div",ct,[t("button",{onClick:q,"aria-label":"Giảm số lượng"},"-"),t("input",{type:"text",value:o.value,readonly:"","aria-label":"Số lượng hiện tại"},null,8,pt),t("button",{onClick:D,"aria-label":"Tăng số lượng"},"+")]),t("button",{class:"btn-primary",onClick:U},e[5]||(e[5]=[t("i",{class:"fas fa-credit-card"},null,-1),c(" THANH TOÁN ")]))]),e[6]||(e[6]=O('<div class="trust-bar" data-v-cee5b70e><div class="trust-item" data-v-cee5b70e><i class="fas fa-shield-alt" data-v-cee5b70e></i> <span data-v-cee5b70e>Hàng chính hãng 100%</span></div><div class="trust-item" data-v-cee5b70e><i class="fas fa-truck-fast" data-v-cee5b70e></i> <span data-v-cee5b70e>Giao hàng nhanh</span></div><div class="trust-item" data-v-cee5b70e><i class="fas fa-box-open" data-v-cee5b70e></i> <span data-v-cee5b70e>Đổi trả hàng 7 ngày</span></div></div>',1))])]),t("section",vt,[t("div",mt,[e[7]||(e[7]=t("h3",null,"Mô tả chi tiết",-1)),t("p",ht,u(s.value.description||"Chưa có mô tả chi tiết cho sản phẩm này."),1)])]),t("section",ft,[e[8]||(e[8]=t("h2",null,"Sản phẩm tương tự",-1)),e[9]||(e[9]=c()),e[10]||(e[10]=t("br",null,null,-1)),t("div",gt,[(l(!0),d(_,null,N(M.value.slice(0,6),a=>(l(),f(Y,{key:a.ID,product:a},null,8,["product"]))),128))])])])),(l(),f(R,{to:"body"},[z(Q,{name:"modal-fade"},{default:E(()=>[b.value?(l(),d("div",{key:0,class:"modal-backdrop",onClick:w(h,["self"])},[t("div",yt,[t("div",{class:"modal-header"},[e[12]||(e[12]=t("h3",null,"Thông tin đặt hàng",-1)),t("button",{class:"close-btn",onClick:h},e[11]||(e[11]=[t("i",{class:"fa-solid fa-xmark"},null,-1)]))]),t("div",bt,[y.value?(l(),f(S,{key:0,message:"Đang xử lý đơn hàng..."})):(l(),d("div",_t,[t("div",kt,[t("p",null,[e[13]||(e[13]=c("Sản phẩm: ")),t("strong",null,u(s.value.name),1)]),t("p",null,[e[14]||(e[14]=c("Số lượng: ")),t("strong",null,u(o.value),1)]),t("p",null,[e[15]||(e[15]=c("Tổng tiền: ")),t("strong",null,u(P(T)(s.value.price*o.value)),1)])]),t("form",{onSubmit:w(H,["prevent"])},[t("div",Ct,[e[16]||(e[16]=t("label",{for:"name"},"Họ và tên",-1)),p(t("input",{id:"name",type:"text",class:"form-input","onUpdate:modelValue":e[0]||(e[0]=a=>n.value.name=a),placeholder:"Nhập tên của bạn",required:""},null,512),[[k,n.value.name]])]),t("div",Mt,[e[17]||(e[17]=t("label",{for:"phone"},"Số điện thoại",-1)),p(t("input",{id:"phone",type:"tel",class:"form-input","onUpdate:modelValue":e[1]||(e[1]=a=>n.value.phone=a),placeholder:"Nhập số điện thoại của bạn",required:""},null,512),[[k,n.value.phone]])]),t("div",xt,[e[18]||(e[18]=t("label",{for:"address"},"Địa chỉ",-1)),p(t("textarea",{id:"address",class:"form-input","onUpdate:modelValue":e[2]||(e[2]=a=>n.value.address=a),placeholder:"Nhập địa chỉ nhận hàng",required:""},null,512),[[k,n.value.address]])]),t("div",Nt,[e[21]||(e[21]=t("label",null,"Phương thức thanh toán",-1)),t("div",Pt,[t("div",Tt,[p(t("input",{type:"radio","onUpdate:modelValue":e[3]||(e[3]=a=>n.value.paymentMethod=a),value:"cod"},null,512),[[V,n.value.paymentMethod]]),e[19]||(e[19]=t("span",null,"Thanh toán khi nhận hàng",-1))]),t("div",wt,[p(t("input",{type:"radio","onUpdate:modelValue":e[4]||(e[4]=a=>n.value.paymentMethod=a),value:"bank_transfer"},null,512),[[V,n.value.paymentMethod]]),e[20]||(e[20]=t("span",null,"Chuyển khoản ngân hàng",-1))])])]),t("div",{class:"form-actions"},[t("button",{type:"button",class:"btn",onClick:h},"Hủy"),e[22]||(e[22]=t("button",{type:"submit",class:"btn-primary"},"Xác nhận đặt hàng",-1))])],32)]))])])])):J("",!0)]),_:1})]))],64))}},Ut=L(St,[["__scopeId","data-v-cee5b70e"]]);export{Ut as default};
