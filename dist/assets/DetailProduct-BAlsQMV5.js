import{_ as Q,u as j,r as d,B as q,C as X,P as $,c as r,b as k,a as t,F as T,i as D,t as u,h as m,n as c,g as J,j as K,k as W,T as Y,Q as Z,s as tt,R as at,A as x,o,E as et,G as h,w as U,L as B,l as I,d as p,v as C,S as H,p as st}from"./index-BXw2fPDX.js";import{b as lt}from"./category-DejoU3X-.js";import{a as nt}from"./order-Wx-Sp_YB.js";import{P as ot}from"./Card-DU4XyIJW.js";const it={key:1,class:"container"},rt={class:"main-content-grid"},ut={class:"image-gallery"},dt={class:"main-image-wrapper"},ct=["src","alt"],pt={class:"thumbnail-list"},vt=["src","onClick"],mt={class:"info-panel"},ht={class:"product-brand"},ft={class:"product-title"},gt={key:0,class:"price-info"},yt={class:"original-price"},bt={class:"product-price"},_t={key:1,class:"product-price"},kt={class:"actions"},Ct={class:"quantity-selector"},Nt=["value"],Pt={class:"extended-info-grid"},Mt={class:"description-section"},Tt={class:"pre-line-text"},xt={class:"related-products-section"},wt={class:"product-grid"},St={class:"checkout-modal"},Vt={class:"modal-body"},qt={key:1},Dt={class:"summary"},Ut={key:0},Bt={class:"form-group"},It={class:"form-group"},Ht={class:"form-group"},Ft={class:"form-group"},Et={class:"form-group"},Lt={class:"payment-options"},Rt={class:"radio-label"},zt={class:"radio-label"},At={__name:"DetailProduct",setup(Gt){const f=tt(),N=st(),{showNotification:v}=j(),s=d(null),w=d([]),g=d(!0),P=d(!1),i=d(1),y=d(""),M=d(!1),l=d({name:"",phone:"",address:"",email:"",paymentMethod:"cod"}),F=x,b=q(()=>{var n;return((n=F.value)==null?void 0:n.discountPercentage)||0}),S=q(()=>{var n;return s.value&&b.value>0?s.value.price*(1-b.value):(n=s.value)==null?void 0:n.price}),E=()=>i.value++,L=()=>{i.value>1&&i.value--},R=()=>{M.value=!0},_=()=>{M.value=!1,i.value=1},z=()=>{l.value={name:"",phone:"",address:"",email:"",paymentMethod:"cod"},i.value=1},A=async()=>{P.value=!0;const n={productID:s.value.ID,productName:s.value.name,quantity:i.value,totalPrice:s.value.price*i.value,customerName:l.value.name,customerPhone:l.value.phone,customerAddress:l.value.address,customerEmail:l.value.email,paymentMethod:l.value.paymentMethod};try{await nt(n),v("Đặt hàng thành công! Chúng tôi sẽ sớm liên hệ với bạn để xác nhận."),_(),z()}catch(a){console.error("Failed to submit order:",a),v(a,"error")}finally{P.value=!1}},V=async n=>{var a;if(!n){g.value=!1;return}g.value=!0;try{const[e]=await Promise.all([at(n)]);s.value=e,((a=s.value.image_urls)==null?void 0:a.length)>0&&(y.value=s.value.image_urls[0]),w.value=await lt(s.value.category_id)}catch(e){console.error("Failed to fetch product data:",e),s.value=null,v(e,"error")}finally{g.value=!1}};X(async()=>{V(f.params.id)}),$(()=>f.params.id,n=>{n&&(window.scrollTo(0,0),V(n))});const G=()=>{x.value?R():(v("Bạn cần đăng nhập để tiến hành thanh toán.","error"),N.push({path:"/login",query:{redirect:f.fullPath}}))},O=()=>{x.value?N.push("/chat"):(v("Bạn cần đăng nhập để nhắn tin.","error"),N.push({path:"/login",query:{redirect:f.fullPath}}))};return(n,a)=>(o(),r(T,null,[g.value?(o(),k(B,{key:0,message:"Đang tải..."})):(o(),r("div",it,[t("main",rt,[t("div",ut,[t("div",dt,[t("img",{loading:"lazy",src:y.value,alt:s.value.name,class:"img-main"},null,8,ct)]),t("div",pt,[(o(!0),r(T,null,D(s.value.image_urls,e=>(o(),r("img",{loading:"lazy",key:e,src:e,class:et({active:y.value===e}),onClick:Ot=>y.value=e,alt:"Thumbnail"},null,10,vt))),128))])]),t("div",mt,[t("p",ht,u(s.value.category_name),1),t("h1",ft,u(s.value.name),1),b.value>0?(o(),r("div",gt,[t("p",yt,u(m(h)(s.value.price)),1),t("p",bt,u(m(h)(S.value)),1)])):(o(),r("p",_t,u(m(h)(s.value.price)),1)),t("div",kt,[t("div",Ct,[t("button",{onClick:L,"aria-label":"Giảm số lượng"},"-"),t("input",{type:"text",value:i.value,readonly:"","aria-label":"Số lượng hiện tại"},null,8,Nt),t("button",{onClick:E,"aria-label":"Tăng số lượng"},"+")]),t("button",{class:"btn-primary",onClick:G},a[6]||(a[6]=[t("i",{class:"fas fa-credit-card"},null,-1),c(" THANH TOÁN ")])),t("button",{class:"btn-primary",onClick:O},a[7]||(a[7]=[t("i",{class:"fa-solid fa-comments"},null,-1),c(" NHẮN TIN TUNI ")]))]),a[8]||(a[8]=J('<div class="trust-bar" data-v-fa42c011><div class="trust-item" data-v-fa42c011><i class="fas fa-shield-alt" data-v-fa42c011></i> <span data-v-fa42c011>Hàng chính hãng 100%</span></div><div class="trust-item" data-v-fa42c011><i class="fas fa-truck-fast" data-v-fa42c011></i> <span data-v-fa42c011>Giao hàng nhanh</span></div><div class="trust-item" data-v-fa42c011><i class="fas fa-box-open" data-v-fa42c011></i> <span data-v-fa42c011>Đổi trả hàng 7 ngày</span></div></div>',1))])]),t("section",Pt,[t("div",Mt,[a[9]||(a[9]=t("h3",null,"Mô tả chi tiết",-1)),t("p",Tt,u(s.value.description||"Chưa có mô tả chi tiết cho sản phẩm này."),1)])]),t("section",xt,[a[10]||(a[10]=t("h2",null,"Sản phẩm tương tự",-1)),a[11]||(a[11]=c()),a[12]||(a[12]=t("br",null,null,-1)),t("div",wt,[(o(!0),r(T,null,D(w.value.slice(0,6),e=>(o(),k(ot,{key:e.ID,product:e},null,8,["product"]))),128))])])])),(o(),k(Z,{to:"body"},[K(Y,{name:"modal-fade"},{default:W(()=>[M.value?(o(),r("div",{key:0,class:"modal-backdrop",onClick:U(_,["self"])},[t("div",St,[t("div",{class:"modal-header"},[a[14]||(a[14]=t("h3",null,"Thông tin đặt hàng",-1)),t("button",{class:"close-btn",onClick:_},a[13]||(a[13]=[t("i",{class:"fa-solid fa-xmark"},null,-1)]))]),t("div",Vt,[P.value?(o(),k(B,{key:0,message:"Đang xử lý đơn hàng..."})):(o(),r("div",qt,[t("div",Dt,[t("p",null,[a[15]||(a[15]=c("Sản phẩm: ")),t("strong",null,u(s.value.name),1)]),t("p",null,[a[16]||(a[16]=c("Số lượng: ")),t("strong",null,u(i.value),1)]),t("p",null,[a[17]||(a[17]=c("Tổng tiền: ")),t("strong",null,u(m(h)(s.value.price*i.value)),1)]),b.value>0?(o(),r("p",Ut,[a[18]||(a[18]=c("Thanh toán: ")),t("strong",null,u(m(h)(S.value*i.value)),1)])):I("",!0)]),t("form",{onSubmit:U(A,["prevent"])},[t("div",Bt,[a[19]||(a[19]=t("label",{for:"name"},"Họ và tên",-1)),p(t("input",{id:"name",type:"text",class:"form-input","onUpdate:modelValue":a[0]||(a[0]=e=>l.value.name=e),placeholder:"Nhập tên của bạn",required:""},null,512),[[C,l.value.name]])]),t("div",It,[a[20]||(a[20]=t("label",{for:"email"},"Email",-1)),p(t("input",{id:"email",type:"email",class:"form-input","onUpdate:modelValue":a[1]||(a[1]=e=>l.value.email=e),placeholder:"Nhập email của bạn",required:""},null,512),[[C,l.value.email]])]),t("div",Ht,[a[21]||(a[21]=t("label",{for:"phone"},"Số điện thoại",-1)),p(t("input",{id:"phone",type:"tel",class:"form-input","onUpdate:modelValue":a[2]||(a[2]=e=>l.value.phone=e),placeholder:"Nhập số điện thoại của bạn",required:""},null,512),[[C,l.value.phone]])]),t("div",Ft,[a[22]||(a[22]=t("label",{for:"address"},"Địa chỉ",-1)),p(t("textarea",{id:"address",class:"form-input","onUpdate:modelValue":a[3]||(a[3]=e=>l.value.address=e),placeholder:"Nhập địa chỉ nhận hàng",required:""},null,512),[[C,l.value.address]])]),t("div",Et,[a[25]||(a[25]=t("label",null,"Phương thức thanh toán",-1)),t("div",Lt,[t("div",Rt,[p(t("input",{type:"radio","onUpdate:modelValue":a[4]||(a[4]=e=>l.value.paymentMethod=e),value:"cod"},null,512),[[H,l.value.paymentMethod]]),a[23]||(a[23]=t("span",null,"Thanh toán khi nhận hàng",-1))]),t("div",zt,[p(t("input",{type:"radio","onUpdate:modelValue":a[5]||(a[5]=e=>l.value.paymentMethod=e),value:"bank_transfer"},null,512),[[H,l.value.paymentMethod]]),a[24]||(a[24]=t("span",null,"Chuyển khoản ngân hàng",-1))])])]),t("div",{class:"form-actions"},[t("button",{type:"button",class:"btn",onClick:_},"Hủy"),a[26]||(a[26]=t("button",{type:"submit",class:"btn-primary"},"Xác nhận đặt hàng",-1))])],32)]))])])])):I("",!0)]),_:1})]))],64))}},Jt=Q(At,[["__scopeId","data-v-fa42c011"]]);export{Jt as default};
