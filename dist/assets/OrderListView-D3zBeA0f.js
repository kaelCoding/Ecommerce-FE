import{Q as g,_,r as p,a as y,B as f,c as i,d as t,f as C,m as D,F as w,j as b,o as l,t as c,D as k,g as N,v as V,L}from"./index-BvrMabg1.js";const S=async()=>{try{return await g("GET","/admin/orders")}catch(r){throw r}},I=async(r,e)=>{try{return await g("PUT",`/admin/orders/${r}/shipping-code`,{shippingCode:e})}catch(o){throw o}},A={class:"container"},x={class:"content-area"},T={class:"table-responsive"},B={class:"admin-table"},O={key:1},U={key:0},E={class:"optional-col"},F={class:"optional-col"},M={class:"shipping-code-cell"},Q=["onUpdate:modelValue","disabled"],q=["onClick","disabled"],H={__name:"OrderListView",setup(r){const e=p([]),o=p(!1),d=p({}),{showNotification:u}=y(),v=async()=>{o.value=!0;try{const a=await S();e.value=a||[],Array.isArray(a)&&a.forEach(s=>{d.value[s.ID]=s.shippingCode||""})}catch{u("Lỗi khi tải danh sách đơn hàng","error")}finally{o.value=!1}},m=async a=>{const s=d.value[a];if(!s){u("Vui lòng nhập mã vận đơn.","warning");return}try{await I(a,s),u("Cập nhật mã vận đơn thành công!","success");const n=e.value.find(h=>h.ID===a);n&&(n.shippingCode=s)}catch(n){u(n||"Cập nhật thất bại","error")}};return f(v),(a,s)=>(l(),i("div",A,[s[3]||(s[3]=t("div",{class:"main-header"},[t("h1",null,"Quản lý Đơn Hàng")],-1)),t("div",x,[s[2]||(s[2]=t("div",{class:"content-header"},[t("h2",null,"Danh sách Đơn hàng")],-1)),t("div",T,[t("table",B,[s[1]||(s[1]=t("thead",null,[t("tr",null,[t("th",null,"ID"),t("th",null,"Khách Hàng"),t("th",{class:"optional-col"},"Tổng Tiền"),t("th",{class:"optional-col"},"Ngày Đặt"),t("th",null,"Trạng thái Quay"),t("th",null,"Mã Vận Đơn")])],-1)),o.value?(l(),C(L,{key:0,message:"Đang tải đơn hàng..."})):(l(),i("tbody",O,[!e.value||e.value.length===0?(l(),i("tr",U,s[0]||(s[0]=[t("td",{colspan:"6",style:{"text-align":"center",padding:"2rem"}},"Chưa có đơn hàng nào.",-1)]))):D("",!0),(l(!0),i(w,null,b(e.value,n=>(l(),i("tr",{key:n.ID},[t("td",null,c(n.ID),1),t("td",null,c(n.customerName),1),t("td",E,c(new Intl.NumberFormat("vi-VN").format(n.totalAmount))+"đ",1),t("td",F,c(new Date(n.CreatedAt).toLocaleDateString("vi-VN")),1),t("td",null,[t("span",{class:k(n.hasSpun?"status-spun":"status-unspun")},c(n.hasSpun?"Đã quay":"Chưa quay"),3)]),t("td",null,[t("div",M,[N(t("input",{type:"text","onUpdate:modelValue":h=>d.value[n.ID]=h,placeholder:"Nhập mã...",disabled:n.hasSpun},null,8,Q),[[V,d.value[n.ID]]]),t("button",{onClick:h=>m(n.ID),class:"save-btn",disabled:n.hasSpun}," Lưu ",8,q)])])]))),128))]))])])])]))}},j=_(H,[["__scopeId","data-v-f1927414"]]);export{j as default};
