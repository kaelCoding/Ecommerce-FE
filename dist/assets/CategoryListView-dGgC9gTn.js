import{u as D,r,e as _,c,a as e,x as k,y as d,d as w,F as M,g as x,i as B,o as l,t as f,j as I,L as T}from"./index-EtAjOJnX.js";import{g as V,d as L}from"./category-DNlFesr7.js";import{C as N}from"./ConfirmationModal-DZYD0DFG.js";const F={class:"content-area"},X={class:"content-header"},S={class:"table-responsive"},$={class:"admin-table"},E={key:1},H={class:"table-actions center"},j=["onClick"],R=["onClick"],J={__name:"CategoryListView",setup(q){const{showNotification:u}=D(),h=I(),m=r(!0),o=r(!1),a=r(null),i=r([]);_(async()=>{await g(),m.value=!1});const g=async()=>{try{const t=await V();i.value=t}catch(t){console.error("Failed to get categorys:",t),u("Tải danh sách danh mục thất bại.","error")}},v=t=>{h.push({name:"admin-categories-edit",params:{id:t}})},p=t=>{a.value=t,o.value=!0},y=async()=>{if(o.value=!1,!!a.value)try{await L(a.value),i.value=i.value.filter(t=>t.ID!==a.value),u("Xóa danh mục thành công!")}catch(t){console.error("Failed to delete category:",t),u("Xóa danh mục thất bại. Vui lòng thử lại.","error")}finally{a.value=null}},b=()=>{o.value=!1,a.value=null};return(t,n)=>(l(),c("div",null,[n[6]||(n[6]=e("div",{class:"main-header"},[e("h1",null,"Danh Mục")],-1)),e("div",F,[e("div",X,[n[2]||(n[2]=e("h2",null,"Danh sách Danh Mục",-1)),e("button",{class:"btn-primary",onClick:n[0]||(n[0]=s=>k(h).push({name:"admin-categories-new"}))},n[1]||(n[1]=[e("i",{class:"fas fa-plus"},null,-1),d(" Thêm Mới ")]))]),e("div",S,[e("table",$,[n[5]||(n[5]=e("thead",null,[e("tr",null,[e("th",null,"ID"),e("th",null,"Tên Danh Mục"),e("th",null,"Hành động")])],-1)),m.value?(l(),w(T,{key:0,message:"Đang tải..."})):(l(),c("tbody",E,[(l(!0),c(M,null,x(i.value,s=>(l(),c("tr",{key:s.id},[e("td",null,f(s.ID),1),e("td",null,f(s.name),1),e("td",null,[e("div",H,[e("button",{class:"btn-primary",onClick:C=>v(s.ID)},n[3]||(n[3]=[e("i",{class:"fas fa-edit"},null,-1),d(),e("span",null,"Sửa",-1)]),8,j),e("button",{class:"btn-primary",onClick:C=>p(s.ID)},n[4]||(n[4]=[e("i",{class:"fas fa-trash"},null,-1),d(),e("span",null,"Xóa",-1)]),8,R)])])]))),128))]))])])]),B(N,{show:o.value,title:"Xác nhận xóa danh mục",message:"Bạn có chắc chắn muốn xóa danh mục này không? Hành động này không thể hoàn tác.",onConfirm:y,onCancel:b},null,8,["show"])]))}};export{J as default};
