import{_ as b,K as k,a as w,r as f,C,h as T,b as P,c as i,d as t,w as M,g as u,v as p,W as _,F as V,l as N,f as o,k as x,t as l,e as S,o as r,G as h,L as U}from"./index-B0cCL04z.js";import{c as q}from"./order-DyDVzk1h.js";const B={class:"container checkout-page"},I={class:"checkout-layout"},D={class:"checkout-form card-white"},F={class:"form-group"},O={class:"form-group"},G={class:"form-group"},H={class:"form-group"},L={class:"payment-options"},A={class:"radio-label"},R={class:"radio-label"},E={class:"checkout-summary card-white"},K={class:"summary-items"},W=["src","alt"],X={class:"item-details"},j={class:"item-name"},z={class:"item-price"},J={class:"summary-total"},Q={class:"summary-row"},Y={key:0,class:"summary-row discount-row"},Z={class:"summary-row total"},$=["disabled"],tt={key:1},st={__name:"CheckoutView",setup(et){const n=k(),{showNotification:m}=w(),v=P(),g=T,d=f(!1),a=f({name:"",phone:"",address:"",paymentMethod:"cod"});C(()=>{g.value&&(a.value.name=g.value.username),n.items.length===0&&(m("Giỏ hàng của bạn đang trống.","error"),v.push("/cart"))});const y=async()=>{d.value=!0;try{const c={customerName:a.value.name,customerPhone:a.value.phone,customerAddress:a.value.address,paymentMethod:a.value.paymentMethod};await q(c),m("Đặt hàng thành công! Chúng tôi sẽ sớm liên hệ với bạn.","success"),n.clearCart(),v.push("/")}catch(c){m(c,"error"),d.value=!1}};return(c,s)=>(r(),i("div",B,[t("div",I,[t("div",D,[s[11]||(s[11]=t("h1",{class:"page-title"},"Thông Tin Thanh Toán",-1)),t("form",{onSubmit:M(y,["prevent"])},[t("div",F,[s[5]||(s[5]=t("label",{for:"name"},"Họ và Tên",-1)),u(t("input",{id:"name",type:"text",class:"form-input","onUpdate:modelValue":s[0]||(s[0]=e=>a.value.name=e),placeholder:"Nhập họ và tên của bạn",required:""},null,512),[[p,a.value.name]])]),t("div",O,[s[6]||(s[6]=t("label",{for:"phone"},"Số điện thoại",-1)),u(t("input",{id:"phone",type:"tel",class:"form-input","onUpdate:modelValue":s[1]||(s[1]=e=>a.value.phone=e),placeholder:"Nhập số điện thoại",required:""},null,512),[[p,a.value.phone]])]),t("div",G,[s[7]||(s[7]=t("label",{for:"address"},"Địa chỉ",-1)),u(t("textarea",{id:"address",class:"form-input","onUpdate:modelValue":s[2]||(s[2]=e=>a.value.address=e),placeholder:"Nhập địa chỉ nhận hàng",required:""},null,512),[[p,a.value.address]])]),t("div",H,[s[10]||(s[10]=t("label",null,"Phương thức thanh toán",-1)),t("div",L,[t("div",A,[u(t("input",{type:"radio","onUpdate:modelValue":s[3]||(s[3]=e=>a.value.paymentMethod=e),value:"cod"},null,512),[[_,a.value.paymentMethod]]),s[8]||(s[8]=t("span",null,"Thanh toán khi nhận hàng (COD)",-1))]),t("div",R,[u(t("input",{type:"radio","onUpdate:modelValue":s[4]||(s[4]=e=>a.value.paymentMethod=e),value:"bank_transfer"},null,512),[[_,a.value.paymentMethod]]),s[9]||(s[9]=t("span",null,"Chuyển khoản ngân hàng",-1))])])])],32)]),t("div",E,[s[15]||(s[15]=t("h3",null,"Đơn Hàng Của Bạn",-1)),t("div",K,[(r(!0),i(V,null,N(o(n).items,e=>(r(),i("div",{key:e.ID,class:"summary-item"},[t("img",{src:e.product.image_urls[0],alt:e.product.name,class:"item-image"},null,8,W),t("div",X,[t("span",j,l(e.product.name)+" (x"+l(e.quantity)+")",1),t("span",z,l(o(h)(e.product.price*e.quantity)),1)])]))),128))]),t("div",J,[t("div",Q,[s[12]||(s[12]=t("span",null,"Tạm tính (gốc)",-1)),t("strong",null,l(o(h)(o(n).cartOriginalTotalPrice)),1)]),o(n).discountPercentage>0?(r(),i("div",Y,[t("span",null,"Giảm giá VIP (-"+l((o(n).discountPercentage*100).toFixed(0))+"%)",1),t("strong",null,"-"+l(o(h)(o(n).cartOriginalTotalPrice-o(n).cartTotalPrice)),1)])):x("",!0),s[14]||(s[14]=t("div",{class:"summary-row"},[t("span",null,"Phí vận chuyển"),t("strong",null,"Sẽ thông báo sau")],-1)),t("div",Z,[s[13]||(s[13]=t("span",null,"Tổng cộng (chưa gồm ship)",-1)),t("strong",null,l(o(n).formattedCartTotalPrice),1)])]),t("button",{onClick:y,class:"btn-primary btn-checkout",disabled:d.value},[d.value?(r(),S(U,{key:0,message:""})):(r(),i("span",tt,"Xác Nhận Đặt Hàng"))],8,$)])])]))}},nt=b(st,[["__scopeId","data-v-bc0ed4ad"]]);export{nt as default};
