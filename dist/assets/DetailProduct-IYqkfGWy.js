import{l as L,_ as O,m as I,r as d,k as z,n as E,c as r,b as g,a as t,F as k,d as w,t as u,p as N,q as f,x as K,y as Q,z as R,T as X,A as $,h as j,B as J,g as W,e as o,C as Y,D as S,w as V,L as D,f as c,v as C,E as q,G as Z}from"./index-B4XQbLVi.js";import{P as tt}from"./Card-B3pIwIP-.js";const at=async x=>{try{return await L("POST","/orders",x)}catch(v){throw v}},st={key:1,class:"page-state"},et={key:2,class:"container"},nt={class:"main-content-grid"},ot={class:"image-gallery"},lt={class:"main-image-wrapper"},it=["src","alt"],dt={class:"thumbnail-list"},rt=["src","onClick"],ut={class:"info-panel"},ct={class:"product-brand"},vt={class:"product-title"},pt={class:"product-price"},mt={class:"actions"},ht={class:"quantity-selector"},gt=["value"],ft={class:"extended-info-grid"},yt={class:"description-section"},_t={class:"pre-line-text"},bt={class:"related-products-section"},kt={class:"product-grid"},Ct={class:"checkout-modal"},xt={class:"modal-body"},Mt={key:1},Pt={class:"order-summary"},Tt={class:"form-group"},wt={class:"form-group"},Nt={class:"form-group"},St={class:"form-group"},Vt={class:"payment-options"},Dt={class:"radio-label"},qt={class:"radio-label"},Bt={__name:"DetailProduct",setup(x){const v=j(),{showNotification:y}=I(),e=d(null),M=d([]),p=d(!0),_=d(!1),l=d(1),m=d(""),b=d(!1),n=d({name:"",phone:"",address:"",paymentMethod:"cod"}),B=()=>l.value++,F=()=>{l.value>1&&l.value--},H=()=>{b.value=!0},h=()=>{b.value=!1},U=()=>{n.value={name:"",phone:"",address:"",paymentMethod:"cod"},l.value=1},A=async()=>{_.value=!0;const i={productName:e.value.name,quantity:l.value,totalPrice:e.value.price*l.value,customerName:n.value.name,customerPhone:n.value.phone,customerAddress:n.value.address,paymentMethod:n.value.paymentMethod};try{await at(i),y("Đặt hàng thành công! Chúng tôi sẽ sớm liên hệ với bạn để xác nhận."),h(),U()}catch(a){console.error("Failed to submit order:",a),y("Gửi đơn hàng thất bại. Vui lòng thử lại.","error")}finally{_.value=!1}},P=async i=>{var a;if(!i){p.value=!1;return}p.value=!0;try{const[s,T]=await Promise.all([J(i),W()]);e.value=s,M.value=T,((a=e.value.image_urls)==null?void 0:a.length)>0&&(m.value=e.value.image_urls[0])}catch(s){console.error("Failed to fetch product data:",s),e.value=null,y("Không thể tải dữ liệu sản phẩm.","error")}finally{p.value=!1}};z(async()=>{P(v.params.id)}),E(()=>v.params.id,i=>{i&&(window.scrollTo(0,0),P(i))});const G=()=>{H()};return(i,a)=>(o(),r(k,null,[p.value?(o(),g(D,{key:0,message:"Đang tải..."})):e.value?(o(),r("div",et,[t("main",nt,[t("div",ot,[t("div",lt,[t("img",{src:m.value,alt:e.value.name,class:"img-main"},null,8,it)]),t("div",dt,[(o(!0),r(k,null,w(e.value.image_urls,s=>(o(),r("img",{key:s,src:s,class:Y({active:m.value===s}),onClick:T=>m.value=s,alt:"Thumbnail"},null,10,rt))),128))])]),t("div",ut,[t("p",ct,u(e.value.category_name),1),t("h1",vt,u(e.value.name),1),t("p",pt,u(N(S)(e.value.price)),1),t("div",mt,[t("div",ht,[t("button",{onClick:F,"aria-label":"Giảm số lượng"},"-"),t("input",{type:"text",value:l.value,readonly:"","aria-label":"Số lượng hiện tại"},null,8,gt),t("button",{onClick:B,"aria-label":"Tăng số lượng"},"+")]),t("button",{class:"btn-primary",onClick:G},a[5]||(a[5]=[t("i",{class:"fas fa-credit-card"},null,-1),f(" THANH TOÁN ")]))]),a[6]||(a[6]=K('<div class="trust-bar" data-v-152a2077><div class="trust-item" data-v-152a2077><i class="fas fa-shield-alt" data-v-152a2077></i> <span data-v-152a2077>Hàng chính hãng 100%</span></div><div class="trust-item" data-v-152a2077><i class="fas fa-truck-fast" data-v-152a2077></i> <span data-v-152a2077>Giao hàng nhanh</span></div><div class="trust-item" data-v-152a2077><i class="fas fa-box-open" data-v-152a2077></i> <span data-v-152a2077>Đổi trả hàng 7 ngày</span></div></div>',1))])]),t("section",ft,[t("div",yt,[a[7]||(a[7]=t("h3",null,"Mô tả chi tiết",-1)),t("p",_t,u(e.value.description||"Chưa có mô tả chi tiết cho sản phẩm này."),1)])]),t("section",bt,[a[8]||(a[8]=t("h2",null,"Sản phẩm tương tự",-1)),t("div",kt,[(o(!0),r(k,null,w(M.value,s=>(o(),g(tt,{key:s.ID,product:s},null,8,["product"]))),128))])])])):(o(),r("div",st,"Không tìm thấy sản phẩm.")),(o(),g($,{to:"body"},[Q(X,{name:"modal-fade"},{default:R(()=>[b.value?(o(),r("div",{key:0,class:"checkout-modal-backdrop",onClick:V(h,["self"])},[t("div",Ct,[t("div",{class:"modal-header"},[a[10]||(a[10]=t("h3",null,"Thông tin đặt hàng",-1)),t("button",{class:"close-btn",onClick:h},a[9]||(a[9]=[t("i",{class:"fa-solid fa-xmark"},null,-1)]))]),t("div",xt,[_.value?(o(),g(D,{key:0,message:"Đang xử lý đơn hàng..."})):(o(),r("div",Mt,[t("div",Pt,[t("p",null,[a[11]||(a[11]=f("Sản phẩm: ")),t("strong",null,u(e.value.name),1)]),t("p",null,[a[12]||(a[12]=f("Số lượng: ")),t("strong",null,u(l.value),1)]),t("p",null,[a[13]||(a[13]=f("Tổng tiền: ")),t("strong",null,u(N(S)(e.value.price*l.value)),1)])]),t("form",{onSubmit:V(A,["prevent"])},[t("div",Tt,[a[14]||(a[14]=t("label",{for:"name"},"Họ và tên",-1)),c(t("input",{id:"name",type:"text","onUpdate:modelValue":a[0]||(a[0]=s=>n.value.name=s),required:""},null,512),[[C,n.value.name]])]),t("div",wt,[a[15]||(a[15]=t("label",{for:"phone"},"Số điện thoại",-1)),c(t("input",{id:"phone",type:"tel","onUpdate:modelValue":a[1]||(a[1]=s=>n.value.phone=s),required:""},null,512),[[C,n.value.phone]])]),t("div",Nt,[a[16]||(a[16]=t("label",{for:"address"},"Địa chỉ",-1)),c(t("textarea",{id:"address","onUpdate:modelValue":a[2]||(a[2]=s=>n.value.address=s),required:""},null,512),[[C,n.value.address]])]),t("div",St,[a[19]||(a[19]=t("label",null,"Phương thức thanh toán",-1)),t("div",Vt,[t("div",Dt,[c(t("input",{type:"radio","onUpdate:modelValue":a[3]||(a[3]=s=>n.value.paymentMethod=s),value:"cod"},null,512),[[q,n.value.paymentMethod]]),a[17]||(a[17]=t("span",null,"Thanh toán khi nhận hàng",-1))]),t("div",qt,[c(t("input",{type:"radio","onUpdate:modelValue":a[4]||(a[4]=s=>n.value.paymentMethod=s),value:"bank_transfer"},null,512),[[q,n.value.paymentMethod]]),a[18]||(a[18]=t("span",null,"Chuyển khoản ngân hàng",-1))])])]),t("div",{class:"form-actions"},[t("button",{type:"button",class:"btn",onClick:h},"Hủy"),a[20]||(a[20]=t("button",{type:"submit",class:"btn-primary"},"Xác nhận đặt hàng",-1))])],32)]))])])])):Z("",!0)]),_:1})]))],64))}},Ut=O(Bt,[["__scopeId","data-v-152a2077"]]);export{Ut as default};
