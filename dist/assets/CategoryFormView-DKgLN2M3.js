import{u as v,r as b,B as l,Z as _,o as C,c as p,d as t,t as h,e as w,w as k,f as S,v as x,k as B,x as M,b as T,a as d,L as D}from"./index-2x8Qa1C7.js";import{u as N,c as I}from"./category-CiiF-dVP.js";import{u as L}from"./admin-Drral4SD.js";const V={class:"main-header"},E={class:"content-area"},F={class:"form-group"},R={class:"form-actions"},q=["disabled"],$={__name:"CategoryFormView",setup(A){const{showNotification:n}=v(),i=L(),o=b(!1),u=M(),c=T(),r=l(()=>!!u.params.id),y=l(()=>r.value?"Sửa Danh Mục":"Thêm Danh Mục Mới"),f=l(()=>r.value?"Cập Nhật":"Thêm Danh Mục"),s=_({id:null,name:""});C(async()=>{if(r.value){o.value=!0;try{const e=Number(u.params.id),a=await i.fetchCategoryById(e);s.id=a.ID,s.name=a.name}catch(e){console.error("Failed to fetch category data:",e),n(e.message||e,"error"),c.push({name:"admin-categories"})}finally{o.value=!1}}});const g=async()=>{o.value=!0;try{if(r.value){const e={name:s.name},a=await N(s.id,e);i.updateCategory(a),n("Cập nhật danh mục thành công!")}else{const e=await I({name:s.name});i.addCategory(e),n("Thêm danh mục thành công!")}c.push({name:"admin-categories"})}catch(e){console.error("Submit failed:",e),n(e.message||e,"error")}finally{o.value=!1}};return(e,a)=>(d(),p("div",null,[t("div",V,[t("h1",null,h(y.value),1)]),t("div",E,[o.value?(d(),w(D,{key:0,message:"Đang tải..."})):(d(),p("form",{key:1,onSubmit:k(g,["prevent"])},[t("div",F,[a[2]||(a[2]=t("label",{for:"name"},"Tên danh mục",-1)),S(t("input",{"onUpdate:modelValue":a[0]||(a[0]=m=>s.name=m),type:"text",id:"name",class:"form-input",placeholder:"Nhập danh mục",required:""},null,512),[[x,s.name]])]),t("div",R,[t("button",{type:"button",class:"btn",onClick:a[1]||(a[1]=m=>B(c).back())},"Hủy"),t("button",{type:"submit",class:"btn-primary",disabled:o.value},h(o.value?"Đang xử lý...":f.value),9,q)])],32))])]))}};export{$ as default};
