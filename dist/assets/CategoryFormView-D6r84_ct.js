import{u as v,r as b,A as l,X as _,B as C,c as p,b as t,t as h,d as w,w as S,e as k,v as B,i as M,s as T,a as x,o as d,L as D}from"./index-TAlcRXIZ.js";import{u as N,c as I}from"./category-CImB7S0T.js";import{u as L}from"./admin-XgqoHkYf.js";const V={class:"main-header"},A={class:"content-area"},E={class:"form-group"},F={class:"form-actions"},R=["disabled"],$={__name:"CategoryFormView",setup(q){const{showNotification:n}=v(),i=L(),o=b(!1),u=T(),c=x(),r=l(()=>!!u.params.id),y=l(()=>r.value?"Sửa Danh Mục":"Thêm Danh Mục Mới"),g=l(()=>r.value?"Cập Nhật":"Thêm Danh Mục"),s=_({id:null,name:""});C(async()=>{if(r.value){o.value=!0;try{const e=Number(u.params.id),a=await i.fetchCategoryById(e);s.id=a.ID,s.name=a.name}catch(e){console.error("Failed to fetch category data:",e),n(e.message||e,"error"),c.push({name:"admin-categories"})}finally{o.value=!1}}});const f=async()=>{o.value=!0;try{if(r.value){const e={name:s.name},a=await N(s.id,e);i.updateCategory(a),n("Cập nhật danh mục thành công!")}else{const e=await I({name:s.name});i.addCategory(e),n("Thêm danh mục thành công!")}c.push({name:"admin-categories"})}catch(e){console.error("Submit failed:",e),n(e.message||e,"error")}finally{o.value=!1}};return(e,a)=>(d(),p("div",null,[t("div",V,[t("h1",null,h(y.value),1)]),t("div",A,[o.value?(d(),w(D,{key:0,message:"Đang tải..."})):(d(),p("form",{key:1,onSubmit:S(f,["prevent"])},[t("div",E,[a[2]||(a[2]=t("label",{for:"name"},"Tên danh mục",-1)),k(t("input",{"onUpdate:modelValue":a[0]||(a[0]=m=>s.name=m),type:"text",id:"name",class:"form-input",placeholder:"Nhập danh mục",required:""},null,512),[[B,s.name]])]),t("div",F,[t("button",{type:"button",class:"btn",onClick:a[1]||(a[1]=m=>M(c).back())},"Hủy"),t("button",{type:"submit",class:"btn-primary",disabled:o.value},h(o.value?"Đang xử lý...":g.value),9,R)])],32))])]))}};export{$ as default};
