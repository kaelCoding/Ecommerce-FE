import{u as D,r as u,e as C,p as w,c as o,a as n,x as p,y as d,d as N,F as P,g as V,i as x,N as B,o as l,h as T,t as h,D as I,j as L,L as S}from"./index-EtAjOJnX.js";import{C as F}from"./ConfirmationModal-DZYD0DFG.js";const M={class:"container"},X={class:"content-area"},$={class:"content-header"},E={class:"table-responsive"},H={class:"admin-table"},j={key:1},G=["src","alt"],R={class:"table-actions center"},q=["onClick"],z=["onClick"],O={__name:"ProductListView",setup(A){const{showNotification:c}=D(),m=L(),f=u(!0),i=u(!1),a=u(null),r=u([]);C(async()=>{await v(),f.value=!1});const v=async()=>{try{const e=await w();r.value=e}catch(e){console.error("Failed to get products:",e),c("Tải danh sách sản phẩm thất bại.","error")}},g=e=>{m.push({name:"admin-products-edit",params:{id:e}})},_=e=>{a.value=e,i.value=!0},y=async()=>{if(i.value=!1,!!a.value)try{await B(a.value),r.value=r.value.filter(e=>e.ID!==a.value),c("Xóa sản phẩm thành công!")}catch(e){console.error("Failed to delete product:",e),c("Xóa sản phẩm thất bại. Vui lòng thử lại.","error")}finally{a.value=null}},b=()=>{i.value=!1,a.value=null};return(e,t)=>(l(),o("div",M,[t[6]||(t[6]=n("div",{class:"main-header"},[n("h1",null,"Sản Phẩm")],-1)),n("div",X,[n("div",$,[t[2]||(t[2]=n("h2",null,"Danh sách Sản Phẩm",-1)),n("button",{class:"btn btn-primary",onClick:t[0]||(t[0]=s=>p(m).push({name:"admin-products-new"}))},t[1]||(t[1]=[n("i",{class:"fas fa-plus"},null,-1),d(" Thêm Mới ")]))]),n("div",E,[n("table",H,[t[5]||(t[5]=n("thead",null,[n("tr",null,[n("th",null,"Ảnh"),n("th",null,"Tên"),n("th",null,"Danh mục"),n("th",null,"Giá"),n("th",null,"Hành động")])],-1)),f.value?(l(),N(S,{key:0,message:"Đang tải..."})):(l(),o("tbody",j,[(l(!0),o(P,null,V(r.value,s=>(l(),o("tr",{key:s.ID},[n("td",null,[s.image_urls&&s.image_urls.length>0?(l(),o("img",{key:0,src:s.image_urls[0],alt:s.name,class:"table-img"},null,8,G)):T("",!0)]),n("td",null,h(s.name),1),n("td",null,h(s.category_name),1),n("td",null,h(p(I)(s.price)),1),n("td",null,[n("div",R,[n("button",{class:"btn-primary",onClick:k=>g(s.ID)},t[3]||(t[3]=[n("i",{class:"fas fa-edit"},null,-1),d(),n("span",null,"Sửa",-1)]),8,q),n("button",{class:"btn-primary",onClick:k=>_(s.ID)},t[4]||(t[4]=[n("i",{class:"fas fa-trash"},null,-1),d(),n("span",null,"Xóa",-1)]),8,z)])])]))),128))]))])])]),x(F,{show:i.value,title:"Xác nhận xóa sản phẩm",message:"Bạn có chắc chắn muốn xóa sản phẩm này không? Hành động này không thể hoàn tác.",onConfirm:y,onCancel:b},null,8,["show"])]))}};export{O as default};
