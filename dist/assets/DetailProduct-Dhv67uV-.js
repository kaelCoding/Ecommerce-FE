import{_ as E,u as Q,r,B as R,M as A,c as u,b as y,a as t,F as N,i as x,t as d,h as T,n as c,g as G,j,k as z,T as X,N as $,s as J,O as K,C as w,o as n,I as W,P as V,w as S,L as q,d as p,v as b,Q as B,l as Y,p as Z}from"./index-DqITul0o.js";import{b as tt}from"./category-DM9empl2.js";import{a as at}from"./order-BWtxsC9r.js";import{P as et}from"./Card-Dfl4415v.js";const st={key:1,class:"container"},lt={class:"main-content-grid"},nt={class:"image-gallery"},ot={class:"main-image-wrapper"},it=["src","alt"],rt={class:"thumbnail-list"},ut=["src","onClick"],dt={class:"info-panel"},ct={class:"product-brand"},pt={class:"product-title"},mt={class:"product-price"},vt={class:"actions"},ht={class:"quantity-selector"},ft=["value"],gt={class:"extended-info-grid"},yt={class:"description-section"},bt={class:"pre-line-text"},_t={class:"related-products-section"},kt={class:"product-grid"},Ct={class:"checkout-modal"},Nt={class:"modal-body"},Mt={key:1},Pt={class:"summary"},xt={class:"form-group"},Tt={class:"form-group"},wt={class:"form-group"},Vt={class:"form-group"},St={class:"form-group"},qt={class:"payment-options"},Bt={class:"radio-label"},Dt={class:"radio-label"},Ut={__name:"DetailProduct",setup(Ht){const v=J(),_=Z(),{showNotification:m}=Q(),l=r(null),M=r([]),h=r(!0),k=r(!1),o=r(1),f=r(""),C=r(!1),s=r({name:"",phone:"",address:"",email:"",paymentMethod:"cod"}),D=()=>o.value++,U=()=>{o.value>1&&o.value--},H=()=>{C.value=!0},g=()=>{C.value=!1,o.value=1},I=()=>{s.value={name:"",phone:"",address:"",email:"",paymentMethod:"cod"},o.value=1},F=async()=>{k.value=!0;const i={productName:l.value.name,quantity:o.value,totalPrice:l.value.price*o.value,customerName:s.value.name,customerPhone:s.value.phone,customerAddress:s.value.address,customerEmail:s.value.email,paymentMethod:s.value.paymentMethod};try{await at(i),m("Đặt hàng thành công! Chúng tôi sẽ sớm liên hệ với bạn để xác nhận."),g(),I()}catch(a){console.error("Failed to submit order:",a),m(a,"error")}finally{k.value=!1}},P=async i=>{var a;if(!i){h.value=!1;return}h.value=!0;try{const[e]=await Promise.all([K(i)]);l.value=e,((a=l.value.image_urls)==null?void 0:a.length)>0&&(f.value=l.value.image_urls[0]),M.value=await tt(l.value.category_id)}catch(e){console.error("Failed to fetch product data:",e),l.value=null,m(e,"error")}finally{h.value=!1}};R(async()=>{P(v.params.id)}),A(()=>v.params.id,i=>{i&&(window.scrollTo(0,0),P(i))});const L=()=>{w.value?H():(m("Bạn cần đăng nhập để tiến hành thanh toán.","error"),_.push({path:"/login",query:{redirect:v.fullPath}}))},O=()=>{w.value?_.push("/chat"):(m("Bạn cần đăng nhập để nhắn tin.","error"),_.push({path:"/login",query:{redirect:v.fullPath}}))};return(i,a)=>(n(),u(N,null,[h.value?(n(),y(q,{key:0,message:"Đang tải..."})):(n(),u("div",st,[t("main",lt,[t("div",nt,[t("div",ot,[t("img",{src:f.value,alt:l.value.name,class:"img-main"},null,8,it)]),t("div",rt,[(n(!0),u(N,null,x(l.value.image_urls,e=>(n(),u("img",{key:e,src:e,class:W({active:f.value===e}),onClick:It=>f.value=e,alt:"Thumbnail"},null,10,ut))),128))])]),t("div",dt,[t("p",ct,d(l.value.category_name),1),t("h1",pt,d(l.value.name),1),t("p",mt,d(T(V)(l.value.price)),1),t("div",vt,[t("div",ht,[t("button",{onClick:U,"aria-label":"Giảm số lượng"},"-"),t("input",{type:"text",value:o.value,readonly:"","aria-label":"Số lượng hiện tại"},null,8,ft),t("button",{onClick:D,"aria-label":"Tăng số lượng"},"+")]),t("button",{class:"btn-primary",onClick:L},a[6]||(a[6]=[t("i",{class:"fas fa-credit-card"},null,-1),c(" THANH TOÁN ")])),t("button",{class:"btn-primary",onClick:O},a[7]||(a[7]=[t("i",{class:"fa-solid fa-comments"},null,-1),c(" NHẮN TIN TUNI ")]))]),a[8]||(a[8]=G('<div class="trust-bar" data-v-84f2c6cf><div class="trust-item" data-v-84f2c6cf><i class="fas fa-shield-alt" data-v-84f2c6cf></i> <span data-v-84f2c6cf>Hàng chính hãng 100%</span></div><div class="trust-item" data-v-84f2c6cf><i class="fas fa-truck-fast" data-v-84f2c6cf></i> <span data-v-84f2c6cf>Giao hàng nhanh</span></div><div class="trust-item" data-v-84f2c6cf><i class="fas fa-box-open" data-v-84f2c6cf></i> <span data-v-84f2c6cf>Đổi trả hàng 7 ngày</span></div></div>',1))])]),t("section",gt,[t("div",yt,[a[9]||(a[9]=t("h3",null,"Mô tả chi tiết",-1)),t("p",bt,d(l.value.description||"Chưa có mô tả chi tiết cho sản phẩm này."),1)])]),t("section",_t,[a[10]||(a[10]=t("h2",null,"Sản phẩm tương tự",-1)),a[11]||(a[11]=c()),a[12]||(a[12]=t("br",null,null,-1)),t("div",kt,[(n(!0),u(N,null,x(M.value.slice(0,6),e=>(n(),y(et,{key:e.ID,product:e},null,8,["product"]))),128))])])])),(n(),y($,{to:"body"},[j(X,{name:"modal-fade"},{default:z(()=>[C.value?(n(),u("div",{key:0,class:"modal-backdrop",onClick:S(g,["self"])},[t("div",Ct,[t("div",{class:"modal-header"},[a[14]||(a[14]=t("h3",null,"Thông tin đặt hàng",-1)),t("button",{class:"close-btn",onClick:g},a[13]||(a[13]=[t("i",{class:"fa-solid fa-xmark"},null,-1)]))]),t("div",Nt,[k.value?(n(),y(q,{key:0,message:"Đang xử lý đơn hàng..."})):(n(),u("div",Mt,[t("div",Pt,[t("p",null,[a[15]||(a[15]=c("Sản phẩm: ")),t("strong",null,d(l.value.name),1)]),t("p",null,[a[16]||(a[16]=c("Số lượng: ")),t("strong",null,d(o.value),1)]),t("p",null,[a[17]||(a[17]=c("Tổng tiền: ")),t("strong",null,d(T(V)(l.value.price*o.value)),1)])]),t("form",{onSubmit:S(F,["prevent"])},[t("div",xt,[a[18]||(a[18]=t("label",{for:"name"},"Họ và tên",-1)),p(t("input",{id:"name",type:"text",class:"form-input","onUpdate:modelValue":a[0]||(a[0]=e=>s.value.name=e),placeholder:"Nhập tên của bạn",required:""},null,512),[[b,s.value.name]])]),t("div",Tt,[a[19]||(a[19]=t("label",{for:"email"},"Email",-1)),p(t("input",{id:"email",type:"email",class:"form-input","onUpdate:modelValue":a[1]||(a[1]=e=>s.value.email=e),placeholder:"Nhập email của bạn",required:""},null,512),[[b,s.value.email]])]),t("div",wt,[a[20]||(a[20]=t("label",{for:"phone"},"Số điện thoại",-1)),p(t("input",{id:"phone",type:"tel",class:"form-input","onUpdate:modelValue":a[2]||(a[2]=e=>s.value.phone=e),placeholder:"Nhập số điện thoại của bạn",required:""},null,512),[[b,s.value.phone]])]),t("div",Vt,[a[21]||(a[21]=t("label",{for:"address"},"Địa chỉ",-1)),p(t("textarea",{id:"address",class:"form-input","onUpdate:modelValue":a[3]||(a[3]=e=>s.value.address=e),placeholder:"Nhập địa chỉ nhận hàng",required:""},null,512),[[b,s.value.address]])]),t("div",St,[a[24]||(a[24]=t("label",null,"Phương thức thanh toán",-1)),t("div",qt,[t("div",Bt,[p(t("input",{type:"radio","onUpdate:modelValue":a[4]||(a[4]=e=>s.value.paymentMethod=e),value:"cod"},null,512),[[B,s.value.paymentMethod]]),a[22]||(a[22]=t("span",null,"Thanh toán khi nhận hàng",-1))]),t("div",Dt,[p(t("input",{type:"radio","onUpdate:modelValue":a[5]||(a[5]=e=>s.value.paymentMethod=e),value:"bank_transfer"},null,512),[[B,s.value.paymentMethod]]),a[23]||(a[23]=t("span",null,"Chuyển khoản ngân hàng",-1))])])]),t("div",{class:"form-actions"},[t("button",{type:"button",class:"btn",onClick:g},"Hủy"),a[25]||(a[25]=t("button",{type:"submit",class:"btn-primary"},"Xác nhận đặt hàng",-1))])],32)]))])])])):Y("",!0)]),_:1})]))],64))}},Qt=E(Ut,[["__scopeId","data-v-84f2c6cf"]]);export{Qt as default};
